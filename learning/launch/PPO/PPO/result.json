{"episode_reward_max": -912.0465465828659, "episode_reward_min": -1133.7628083438228, "episode_reward_mean": -1024.786266142474, "episode_len_mean": 53.31818181818182, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1033.8564167011054, -1040.9109902937337, -1039.1786052124119, -1066.7178730607484, -986.697911922012, -1095.4371160831713, -1046.7517147717851, -1035.6325258155812, -969.7304046736551, -1021.1144985421607, -1048.7249918005225, -1036.0993808624426, -1044.0783600964828, -969.0640697898287, -1019.6596977922909, -1050.3036427818442, -1033.9349468424696, -1120.5032020910098, -1011.4579934268161, -1041.003464730543, -1031.3223451694796, -1072.5031108497685, -945.1756958006794, -1042.3121593071323, -1038.109425650696, -1056.6921346775275, -1021.6653245215447, -1081.8058628848719, -1031.473123789299, -912.0465465828659, -1040.87469150592, -1037.6281708388228, -1050.3328599820234, -992.8936861293039, -945.2916219888298, -1055.1111472463713, -1036.457680501835, -960.2955208695763, -1042.486489743036, -1038.2141321033612, -1049.2718455316513, -963.8926033298119, -1044.2849747629873, -1038.733404424648, -1068.0380687830677, -994.5682061816564, -1011.8363409571353, -962.1664402788741, -1051.0688665448295, -1036.4727145989807, -1046.7922858064571, -993.5436755829767, -957.0293305618025, -1129.8887636929792, -1035.3465125265632, -966.9844902961062, -1042.634340551252, -1039.230718728975, -1055.251373649598, -994.3371688118257, -975.2534878306635, -1044.532001158263, -1033.7109443822226, -1049.1035829165535, -992.1524043927803, -1021.4322240871181, -949.30851666755, -1045.54717678424, -1050.1670420879511, -1043.3342852697592, -952.5048844829154, -1049.5868715641423, -1029.0911163778878, -1017.5518636296232, -1056.1211432275854, -1036.611283412674, -1054.2342033385735, -988.8842180077031, -995.0621995767563, -1049.7789982354714, -1038.5053931934979, -1130.6380147668076, -961.3222704220619, -1132.1286625951432, -1029.0030544103047, -1033.0526171962529, -1051.9854206853984, -1031.107101294826, -973.5340653953514, -988.3682912835073, -1033.8229221081112, -1051.7268186501951, -994.6056043620328, -964.4737972603103, -1051.8195191901104, -1040.4163273664617, -1133.7628083438228, -956.2239445296366, -968.055572293752, -1052.712127002299, -1031.495574824591, -944.5797204142516, -921.6083105780615, -1065.0347838453677, -1036.187161576957, -1043.3208942434717, -976.0145873212463, -1061.7994925638213, -1031.6655560110041, -938.628751477335], "episode_lengths": [64, 36, 17, 42, 37, 153, 37, 16, 196, 82, 48, 16, 26, 60, 41, 50, 15, 68, 64, 39, 14, 44, 84, 47, 17, 34, 48, 80, 14, 108, 38, 17, 30, 23, 80, 50, 16, 48, 42, 17, 30, 53, 40, 17, 95, 21, 211, 53, 72, 16, 28, 24, 55, 142, 16, 44, 39, 17, 56, 19, 85, 38, 15, 29, 24, 80, 61, 140, 44, 19, 133, 44, 13, 48, 52, 16, 33, 32, 69, 45, 17, 77, 48, 159, 13, 142, 47, 14, 37, 91, 15, 31, 23, 47, 47, 18, 106, 135, 113, 47, 14, 73, 93, 76, 16, 26, 139, 69, 14, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.789987276324451, "mean_inference_ms": 12.81970882784697, "mean_action_processing_ms": 0.3706299082684102, "mean_env_wait_ms": 57.2687442805366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 7956, "timesteps_this_iter": 7956, "agent_timesteps_total": 7956, "timers": {"sample_time_ms": 21052.665, "sample_throughput": 377.909, "load_time_ms": 113.101, "load_throughput": 70344.499, "learn_time_ms": 24475.098, "learn_throughput": 325.065, "update_time_ms": 28.979}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 348815.6728042603, "policy_loss": -0.06975692293146045, "vf_loss": 348815.7318798762, "vf_explained_var": 0.003392194772279391, "kl": 0.04826591433966607, "entropy": 1.4021451559118046, "entropy_coeff": 0.0}}}, "num_steps_sampled": 7956, "num_agent_steps_sampled": 7956, "num_steps_trained": 7956, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 7956}, "done": false, "episodes_total": 110, "training_iteration": 1, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-10-21", "timestamp": 1648645821, "time_this_iter_s": 45.67260003089905, "time_total_s": 45.67260003089905, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 45.67260003089905, "timesteps_since_restore": 7956, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.646153846153846, "ram_util_percent": 6.510769230769231}}
{"episode_reward_max": -932.6645874488268, "episode_reward_min": -1305.1277730220713, "episode_reward_mean": -1026.9326051041917, "episode_len_mean": 79.43, "episode_media": {}, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1043.3208942434717, -976.0145873212463, -1061.7994925638213, -1031.6655560110041, -938.628751477335, -948.7319730754498, -1026.695513771938, -958.6622606606327, -1305.1277730220713, -1052.8325866244943, -1038.323653518457, -1046.0065978805435, -991.7710919710548, -932.6645874488268, -1070.6789744954685, -1004.8208627618778, -1010.880083147206, -949.0612279190402, -957.3616627513654, -1012.0415849763883, -981.3451284046621, -965.9810485273655, -1074.1865790564846, -993.8109682697315, -987.6119201665729, -1017.9056784305196, -968.7110108615459, -966.462198105638, -1167.9929132587129, -994.6349979001591, -1043.0074655257092, -1014.9923015089495, -988.508548019158, -977.5874528986225, -1065.664316705492, -963.4943788924018, -986.1080275057731, -1009.8755003502986, -1062.4657629182118, -1039.1532603637024, -1038.640654576895, -1048.7574369604004, -961.022799834548, -978.3131690213231, -1080.1305354940148, -964.7820146819421, -1143.8241605846224, -955.4925091143147, -1041.471463653828, -1097.5710784957605, -954.361446914346, -1188.7800220290646, -1036.2251077777303, -1153.1992652453216, -990.0574798525072, -981.042868973173, -1145.316570560238, -1036.4520825264206, -1084.4071706335833, -974.4847299044379, -1113.3706169758382, -1020.292553614675, -1077.346535660841, -1009.575948416142, -1054.409852936095, -1023.7691250367707, -991.0123753796671, -1023.561688259597, -1028.9344235752076, -975.8387932620624, -1051.1663275094418, -977.977500629827, -1010.1847144117137, -981.1503996066282, -1008.5352238956602, -943.8605926323957, -1033.6799398274104, -988.8678336187431, -1046.8645216248055, -1059.621309369148, -1031.274872321892, -1118.0068016727732, -993.0955639813126, -1138.0333523349395, -993.8290114139045, -1030.8549171368452, -1037.9286168934268, -1052.2676999926819, -1091.1819415940772, -1125.1383224393614, -1037.1741998665545, -961.2698033132989, -988.09886106659, -1054.3632292612654, -1093.0519083141608, -963.5018968632866, -1028.5708955773684, -1033.7915439723893, -1045.2835713803129, -975.6014846341795], "episode_lengths": [26, 139, 69, 14, 92, 107, 75, 54, 252, 46, 17, 27, 26, 90, 60, 82, 55, 157, 79, 101, 64, 106, 100, 20, 87, 73, 42, 46, 92, 20, 58, 53, 101, 53, 78, 50, 42, 53, 147, 121, 17, 29, 66, 55, 121, 74, 105, 66, 73, 106, 180, 158, 16, 93, 30, 48, 221, 16, 93, 60, 106, 69, 46, 164, 94, 181, 27, 122, 69, 36, 64, 51, 265, 49, 73, 78, 65, 98, 65, 121, 14, 97, 22, 97, 20, 215, 17, 31, 255, 104, 17, 79, 41, 42, 70, 91, 157, 15, 63, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.973860043046891, "mean_inference_ms": 11.625910355100205, "mean_action_processing_ms": 0.32644488926900367, "mean_env_wait_ms": 55.65765514600052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 15912, "timesteps_this_iter": 7956, "agent_timesteps_total": 15912, "timers": {"sample_time_ms": 32729.966, "sample_throughput": 243.08, "load_time_ms": 112.727, "load_throughput": 70577.412, "learn_time_ms": 24587.005, "learn_throughput": 323.586, "update_time_ms": 24.726}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 289041.228541204, "policy_loss": -0.11230060376717599, "vf_loss": 289041.32681632915, "vf_explained_var": 0.007056801165303876, "kl": 0.05230466220477817, "entropy": 1.4040966679332076, "entropy_coeff": 0.0}}}, "num_steps_sampled": 15912, "num_agent_steps_sampled": 15912, "num_steps_trained": 15912, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 15912}, "done": false, "episodes_total": 205, "training_iteration": 2, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-11-05", "timestamp": 1648645865, "time_this_iter_s": 44.603251695632935, "time_total_s": 90.27585172653198, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 90.27585172653198, "timesteps_since_restore": 15912, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 9.182812499999999, "ram_util_percent": 6.717187499999999}}
{"episode_reward_max": -906.6637507265709, "episode_reward_min": -1140.8485222041702, "episode_reward_mean": -1017.8161590495865, "episode_len_mean": 88.62, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1125.1383224393614, -1037.1741998665545, -961.2698033132989, -988.09886106659, -1054.3632292612654, -1093.0519083141608, -963.5018968632866, -1028.5708955773684, -1033.7915439723893, -1045.2835713803129, -975.6014846341795, -970.8165218638326, -1034.70837820278, -1044.1430145519637, -1046.0191214848476, -981.1559960226559, -1091.1647950249314, -1035.6482896593557, -1029.609974578879, -1037.5725763198666, -1038.5155115624252, -1013.1088743215327, -973.8207389444098, -1028.7444225473314, -1033.0733628574978, -1130.1424698264732, -1070.6196640097678, -992.3266843285735, -958.6253599258918, -1069.8945743110617, -1036.9334289817546, -1134.1992909960477, -984.6074366420149, -920.9445057034496, -954.6807183817532, -1041.4869253622235, -1067.7200888244124, -1042.704586930704, -940.0408429162438, -1035.432789030611, -1030.9692335549287, -987.6015130635019, -999.9513077115324, -1046.5249786129655, -906.6637507265709, -1034.5834122590795, -1035.6659672438998, -980.1707759284043, -1016.7276210547452, -967.5817898233081, -1024.5612081580314, -971.1000096202807, -1038.3804942542, -1029.7255801931037, -1043.6137087550605, -1013.6301622594136, -1033.7227318081443, -1036.4645827815925, -1053.6879386602504, -992.3968587300577, -1038.7758271956613, -927.626835806781, -1030.2244091263753, -1135.5540380822601, -955.9598169147094, -1070.5485242259701, -970.3891048180474, -1026.119284946604, -1037.210530830452, -916.3284410480692, -1055.3905148298327, -1012.8831625205397, -991.6924910604488, -975.0152971722179, -1016.6338486360838, -1037.0940747767168, -1140.8485222041702, -971.4585686597858, -999.8435193015129, -997.5686952821579, -1056.3969610905153, -1024.557448410771, -961.8265528131336, -1047.4882555355675, -1026.7699858512387, -1017.0389988702505, -1020.1758183175745, -1010.9096767628148, -1000.463972914669, -957.4921492718125, -974.0860044181347, -1050.136192967611, -1013.6419417814872, -1018.3701539291187, -981.4550750470024, -1043.0507768912582, -984.6453321633533, -1003.4936357028832, -970.6834012537971, -1023.7377775261285], "episode_lengths": [104, 17, 79, 41, 42, 70, 91, 157, 15, 63, 52, 39, 18, 110, 86, 54, 194, 147, 52, 19, 47, 62, 38, 54, 16, 117, 372, 257, 208, 95, 18, 102, 30, 107, 73, 20, 148, 21, 126, 18, 41, 27, 22, 91, 124, 18, 49, 151, 72, 48, 146, 40, 19, 43, 102, 96, 103, 18, 152, 36, 114, 88, 116, 147, 77, 88, 151, 148, 19, 136, 134, 97, 27, 61, 75, 19, 108, 43, 22, 17, 114, 61, 110, 24, 178, 57, 201, 62, 148, 165, 62, 79, 157, 75, 86, 272, 164, 67, 154, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.807856576635438, "mean_inference_ms": 11.113315729663682, "mean_action_processing_ms": 0.32716915340743086, "mean_env_wait_ms": 54.753006570526985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 23868, "timesteps_this_iter": 7956, "agent_timesteps_total": 23868, "timers": {"sample_time_ms": 36077.846, "sample_throughput": 220.523, "load_time_ms": 112.78, "load_throughput": 70544.513, "learn_time_ms": 24620.54, "learn_throughput": 323.145, "update_time_ms": 20.007}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 274905.72864881123, "policy_loss": -0.13563013004053945, "vf_loss": 274905.83906998584, "vf_explained_var": 0.008639251641047898, "kl": 0.053090347728165635, "entropy": 1.4374777703515944, "entropy_coeff": 0.0}}}, "num_steps_sampled": 23868, "num_agent_steps_sampled": 23868, "num_steps_trained": 23868, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 23868}, "done": false, "episodes_total": 294, "training_iteration": 3, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-11-48", "timestamp": 1648645908, "time_this_iter_s": 42.69687247276306, "time_total_s": 132.97272419929504, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 132.97272419929504, "timesteps_since_restore": 23868, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.186885245901639, "ram_util_percent": 6.740983606557377}}
{"episode_reward_max": -896.2113012058943, "episode_reward_min": -1235.4069690730298, "episode_reward_mean": -1006.9971724428377, "episode_len_mean": 75.66386554621849, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1022.4809410007908, -1000.7079474350897, -997.3691626861887, -995.3716596077778, -994.2157120251792, -958.7321144040366, -936.5009111403785, -1022.3909081511631, -1043.8342218407295, -1011.3349151264802, -1039.3144146724155, -1012.5424396734421, -1001.1654117542537, -1001.0497863337234, -997.0163597779595, -1112.6476230803414, -1000.3374082128771, -996.423490222314, -955.8704195571622, -961.3127070744926, -1035.8158996736604, -1061.7631858031787, -1235.4069690730298, -1086.5641197490909, -987.0681504012168, -1046.272971509109, -1040.051475323293, -1032.1957242456174, -978.6917553479467, -1000.084358434471, -997.99258863321, -912.3618456804799, -997.1033222882282, -1035.4895812936375, -965.400456796503, -998.9679846388123, -997.9536847474257, -949.3606660676917, -1183.286884807849, -941.5088486939615, -999.1027802449363, -995.762605971038, -996.7104918290031, -996.7473647937023, -997.3605007963338, -1179.3692929161714, -935.2769386371273, -961.5610161146744, -929.3916266329003, -999.6486486192168, -994.945440347977, -989.1352384506597, -985.3855277306911, -980.5692997041732, -1044.6792199457457, -1042.079579170068, -1126.1804000991074, -1000.7080026785038, -996.5386277061286, -995.0735325592074, -1029.5800149041804, -1008.6703979155615, -1000.6748409076758, -996.5506497569493, -1043.8465266192766, -936.8525518513244, -1038.545320968377, -924.3505555679712, -1040.1434701547325, -1030.717699807034, -930.6859482306644, -948.9930798515825, -1048.3442690108177, -1037.0920565346726, -906.6223246263353, -953.2032363679892, -1041.8084459862125, -896.2113012058943, -1037.0765086532253, -1027.4534458656879, -985.0391023764939, -1000.3657657001554, -998.4541356981999, -984.9559718042833, -932.9382916137255, -999.8066528844464, -997.6294360948898, -1037.3867179820304, -1037.5908101549924, -1105.0424269045004, -976.8027320149779, -1084.1819062603304, -1051.115324781236, -1036.5145291560698, -1005.7835251196977, -999.4414210512697, -1028.0637904302664, -1045.282357391988, -1022.8942183970568, -984.7883522696584, -998.1590253759392, -996.4802967264734, -969.3770266452227, -923.1159521860399, -959.0023878557963, -1037.22439252151, -1050.0563251410242, -1086.9288011567346, -902.6230252658211, -1034.381206301259, -1010.3623479970222, -1080.1084110988056, -1040.1054777910738, -1038.0265446231604, -938.328841421231, -919.3199443337255, -1041.226254653036, -937.3099783693705, -988.8420064294371], "episode_lengths": [144, 20, 18, 79, 64, 140, 106, 60, 22, 100, 20, 108, 146, 20, 18, 139, 23, 17, 56, 55, 18, 109, 183, 134, 142, 75, 20, 43, 36, 24, 18, 172, 17, 140, 48, 23, 19, 88, 125, 99, 23, 19, 17, 135, 55, 255, 88, 49, 89, 21, 21, 87, 71, 151, 23, 54, 145, 19, 17, 134, 48, 138, 19, 18, 213, 86, 19, 144, 20, 43, 111, 105, 25, 50, 283, 59, 21, 141, 18, 100, 28, 23, 15, 101, 89, 22, 18, 61, 19, 114, 40, 143, 137, 18, 91, 53, 60, 48, 103, 31, 26, 19, 152, 160, 54, 18, 62, 153, 118, 17, 236, 142, 20, 50, 142, 141, 21, 83, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.933941763388157, "mean_inference_ms": 10.787571055884234, "mean_action_processing_ms": 0.322545544315988, "mean_env_wait_ms": 54.08728239137569, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 31824, "timesteps_this_iter": 7956, "agent_timesteps_total": 31824, "timers": {"sample_time_ms": 37885.323, "sample_throughput": 210.002, "load_time_ms": 111.957, "load_throughput": 71062.837, "learn_time_ms": 24616.889, "learn_throughput": 323.193, "update_time_ms": 18.986}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 352148.5571981451, "policy_loss": -0.12682742920393744, "vf_loss": 352148.65458649665, "vf_explained_var": 0.011818254154215576, "kl": 0.04360410793248182, "entropy": 1.5108912786488893, "entropy_coeff": 0.0}}}, "num_steps_sampled": 31824, "num_agent_steps_sampled": 31824, "num_steps_trained": 31824, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 31824}, "done": false, "episodes_total": 413, "training_iteration": 4, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-12-31", "timestamp": 1648645951, "time_this_iter_s": 43.16657567024231, "time_total_s": 176.13929986953735, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 176.13929986953735, "timesteps_since_restore": 31824, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.17049180327869, "ram_util_percent": 6.755737704918033}}
{"episode_reward_max": -916.0196684087184, "episode_reward_min": -1150.96892019233, "episode_reward_mean": -1019.5839522506462, "episode_len_mean": 69.65, "episode_media": {}, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-919.3199443337255, -1041.226254653036, -937.3099783693705, -988.8420064294371, -1036.1977103025051, -1117.9676527543734, -980.936746426048, -997.196070215418, -997.5498339080617, -1007.3033093072721, -1000.4999940535797, -997.9054980924647, -994.343320669902, -1000.8300175166106, -1122.36104809967, -1009.3387644703656, -1022.1887635196221, -1001.2422247060812, -997.4011931731324, -984.0522928890236, -916.0196684087184, -1037.724357248027, -1038.5926701862236, -1119.4222689778283, -1001.3337858871176, -1026.0113809455788, -997.389038464319, -982.2264918909905, -1030.895768850378, -1016.0103194919093, -998.7212422036374, -1050.9141864137332, -1039.9433785410915, -1063.9315687764047, -1036.3352926047737, -1047.3928010140216, -980.1348591165263, -1000.7794587807324, -997.9997386336859, -1045.9855155787045, -1060.9542276346056, -1043.5049642228792, -1060.5243256889908, -1037.405671104335, -999.1918866448013, -998.2965989845154, -1050.8086293811282, -1004.0842743008636, -1009.0962642739225, -1102.3646026850233, -1045.0493760566283, -948.7894269867436, -1000.3121356199301, -998.6590136895028, -1018.7496711144678, -999.7910231600946, -997.0401032181361, -1078.000655429662, -1032.140485392661, -973.1279362333248, -999.3804823350894, -998.2147881904589, -1074.7647440651454, -1002.3776327053234, -1126.3314274535169, -1000.367929578457, -996.5895126955777, -1048.5793878616805, -1061.450832375785, -1000.1764864047989, -998.5994245638258, -1043.550649414961, -1060.783885987994, -986.3759099862967, -1057.574985505878, -1150.96892019233, -1037.014553796523, -1096.0442944729912, -981.2545929452547, -1000.3833992595311, -997.5580826831097, -1033.7266624383278, -1017.3514331981986, -997.619329807117, -1049.6959099482706, -977.8485363098868, -1038.8803858824897, -1002.3632950346592, -1001.4373267780777, -994.5841140327664, -1035.7252984312233, -982.8667247701956, -998.5289842038155, -998.1607424530644, -1041.062791258005, -1007.4125225541688, -1041.8749385458416, -1040.9121219424505, -939.6264903403641, -1000.7080069348659], "episode_lengths": [141, 21, 83, 154, 131, 139, 34, 31, 16, 70, 22, 17, 88, 52, 272, 43, 131, 22, 16, 57, 145, 19, 59, 143, 50, 144, 56, 204, 120, 105, 83, 48, 63, 19, 18, 107, 31, 24, 17, 61, 86, 48, 18, 108, 28, 16, 66, 54, 102, 144, 60, 96, 23, 18, 132, 24, 20, 229, 50, 139, 23, 18, 145, 132, 108, 21, 17, 62, 137, 20, 19, 56, 18, 95, 71, 289, 19, 109, 32, 21, 18, 46, 146, 25, 71, 88, 20, 141, 24, 21, 49, 33, 24, 18, 79, 48, 22, 55, 88, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.680778569088807, "mean_inference_ms": 10.59774429222844, "mean_action_processing_ms": 0.31469853743861287, "mean_env_wait_ms": 53.888550882333796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 39780, "timesteps_this_iter": 7956, "agent_timesteps_total": 39780, "timers": {"sample_time_ms": 38780.014, "sample_throughput": 205.157, "load_time_ms": 111.459, "load_throughput": 71380.344, "learn_time_ms": 24647.751, "learn_throughput": 322.788, "update_time_ms": 19.571}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 258247.51466342146, "policy_loss": -0.1434813510786782, "vf_loss": 258247.6210896728, "vf_explained_var": 0.03602140446503957, "kl": 0.03726494009628451, "entropy": 1.5457239755379257, "entropy_coeff": 0.0}}}, "num_steps_sampled": 39780, "num_agent_steps_sampled": 39780, "num_steps_trained": 39780, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 39780}, "done": false, "episodes_total": 509, "training_iteration": 5, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-13-14", "timestamp": 1648645994, "time_this_iter_s": 42.47251892089844, "time_total_s": 218.6118187904358, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 218.6118187904358, "timesteps_since_restore": 39780, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 9.085245901639343, "ram_util_percent": 6.759016393442623}}
{"episode_reward_max": -930.0791662837504, "episode_reward_min": -1220.3305581033455, "episode_reward_mean": -1033.7320087219136, "episode_len_mean": 83.66, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1000.3833992595311, -997.5580826831097, -1033.7266624383278, -1017.3514331981986, -997.619329807117, -1049.6959099482706, -977.8485363098868, -1038.8803858824897, -1002.3632950346592, -1001.4373267780777, -994.5841140327664, -1035.7252984312233, -982.8667247701956, -998.5289842038155, -998.1607424530644, -1041.062791258005, -1007.4125225541688, -1041.8749385458416, -1040.9121219424505, -939.6264903403641, -1000.7080069348659, -999.3275596967231, -1084.8347490422902, -1064.1109421326644, -979.5060706119011, -979.4997521562215, -1006.3173186137959, -1050.3818456325948, -1055.7796385212375, -1057.2246147461155, -930.0791662837504, -1027.2996637679566, -1041.3210797933457, -1220.3305581033455, -1007.5302641058523, -1049.1620659273533, -1061.1706963440492, -994.9913073714432, -1037.5854794122986, -1086.5669214358395, -1000.317756198525, -997.7548105986565, -1043.4584279961996, -1056.1319285812688, -1060.6289422291447, -1040.6384573775886, -1049.4685563597113, -1057.4098245377565, -1089.7328464365382, -942.9467909792818, -1039.0921361609321, -991.1378878443277, -1067.1346351538707, -1046.9203828342413, -1160.5155007480141, -1081.354548963084, -1045.4266609307906, -1056.676097686648, -1087.0760566290055, -1121.0884495433497, -1064.0275519873387, -1171.3788884837256, -1092.7734251019272, -1041.5706081145036, -1017.9069818692291, -966.7146261707679, -1015.2581077097519, -1006.3457545365742, -1000.9440713104007, -997.1730144239731, -982.6662990392603, -1086.161147732433, -1070.4859382173956, -1042.031856462876, -1019.8064370050097, -1017.6051906593767, -1092.513966279821, -1050.1691992395563, -1053.5816643727844, -953.2720817607815, -1041.4308752528168, -1057.8658530666617, -1070.7674691949962, -1017.0105588662558, -1026.8579355118409, -1020.4022279825913, -977.8957779889595, -1000.2040362303389, -997.4119193128706, -1022.2897446405736, -1039.9875297265878, -1170.4838433753832, -1007.2463455943156, -1000.872974176431, -1165.1545816844427, -1007.2648769689288, -1000.0059498153867, -1009.6218794489258, -1027.8184036806076, -1003.9637909008161], "episode_lengths": [21, 18, 46, 146, 25, 71, 88, 20, 141, 24, 21, 49, 33, 24, 18, 79, 48, 22, 55, 88, 20, 134, 120, 19, 56, 103, 78, 45, 70, 17, 86, 122, 49, 316, 41, 83, 80, 66, 105, 242, 23, 19, 47, 61, 18, 50, 51, 17, 92, 137, 48, 111, 20, 98, 133, 103, 26, 83, 192, 118, 19, 173, 113, 43, 115, 162, 142, 47, 21, 17, 54, 145, 191, 154, 91, 73, 75, 58, 16, 83, 224, 98, 79, 90, 73, 124, 457, 22, 19, 83, 140, 125, 94, 23, 140, 115, 81, 73, 96, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.592561268039072, "mean_inference_ms": 10.594797441019052, "mean_action_processing_ms": 0.31751269801862564, "mean_env_wait_ms": 53.81178417720135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 47736, "timesteps_this_iter": 7956, "agent_timesteps_total": 47736, "timers": {"sample_time_ms": 39379.313, "sample_throughput": 202.035, "load_time_ms": 111.268, "load_throughput": 71503.291, "learn_time_ms": 24655.016, "learn_throughput": 322.693, "update_time_ms": 18.005}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 234653.6207864741, "policy_loss": -0.13749573050161965, "vf_loss": 234653.71428147182, "vf_explained_var": 0.025025595227877298, "kl": 0.028665320553518957, "entropy": 1.5412226878507163, "entropy_coeff": 0.0}}}, "num_steps_sampled": 47736, "num_agent_steps_sampled": 47736, "num_steps_trained": 47736, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 47736}, "done": false, "episodes_total": 588, "training_iteration": 6, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-13-56", "timestamp": 1648646036, "time_this_iter_s": 42.22968244552612, "time_total_s": 260.8415012359619, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 260.8415012359619, "timesteps_since_restore": 47736, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.19833333333333, "ram_util_percent": 6.814999999999998}}
{"episode_reward_max": -881.9254535759355, "episode_reward_min": -1208.496587894307, "episode_reward_mean": -1035.5676223580228, "episode_len_mean": 101.73, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977.8957779889595, -1000.2040362303389, -997.4119193128706, -1022.2897446405736, -1039.9875297265878, -1170.4838433753832, -1007.2463455943156, -1000.872974176431, -1165.1545816844427, -1007.2648769689288, -1000.0059498153867, -1009.6218794489258, -1027.8184036806076, -1003.9637909008161, -1068.9906503379425, -1046.994351108087, -1007.8621604397907, -1040.7943995064074, -952.6222350712462, -1121.0933877894597, -1088.731569465704, -1046.2414938702088, -1067.6520722677571, -1043.8118108655628, -1071.8379626002861, -1050.4140214702352, -1060.5424999832205, -985.218749274707, -1005.6660179250159, -992.3677531205755, -979.8894979775042, -956.7151779631389, -1057.2866331199282, -1061.6859395919357, -1027.8910711215967, -975.5291637133967, -1208.496587894307, -1002.9720681714016, -1028.069156156661, -972.4613846563838, -1024.4127912272693, -1063.2704709848715, -1037.3216610441257, -1056.895481155624, -1135.105552314828, -1023.5737115697037, -1045.2506009354634, -1105.6902644921297, -1027.3491583970367, -1046.2105690363126, -1054.1630589587855, -1071.3542078126227, -902.7874405222993, -1044.0908042933327, -1046.8845208188436, -1057.1032649589165, -1023.6902277127693, -924.6609916224738, -1025.8589679791276, -1055.8329073246205, -986.9549716212246, -1052.444315848529, -1076.76492204467, -1035.1661829454245, -1054.5305075578863, -1001.3803177136422, -1044.580214794909, -1045.3062855243663, -1061.0898392406507, -1023.6597238329401, -1124.7486548693125, -991.5016796855596, -1036.331099846543, -1115.9256598642457, -1011.3067202547691, -997.8218197300631, -975.7510744040374, -881.9254535759355, -1041.63298218701, -1046.4262416947606, -1057.23591572123, -1017.4669565772301, -1073.334070813134, -1119.212573901025, -1008.3724880823187, -1014.7905285231428, -1045.5985421734085, -1052.5473744832377, -1060.7299276471267, -1018.3760609631979, -1041.358378580139, -1048.5069682113517, -1063.7439758559372, -1037.4794071094063, -1047.390001515722, -1063.8299028301183, -1060.1556830339775, -1026.3398650173733, -921.4606031044154, -1050.0182222541498], "episode_lengths": [457, 22, 19, 83, 140, 125, 94, 23, 140, 115, 81, 73, 96, 82, 96, 27, 166, 153, 91, 181, 27, 114, 20, 54, 88, 56, 18, 88, 57, 79, 652, 232, 70, 159, 75, 89, 120, 291, 91, 165, 76, 82, 55, 249, 319, 46, 45, 123, 100, 99, 16, 131, 148, 45, 60, 17, 46, 96, 122, 142, 109, 48, 23, 95, 32, 139, 46, 56, 18, 97, 281, 68, 82, 104, 38, 59, 102, 140, 47, 50, 17, 432, 94, 141, 44, 57, 44, 60, 18, 81, 47, 54, 19, 177, 57, 19, 96, 113, 94, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423899816534254, "mean_inference_ms": 10.518935959436446, "mean_action_processing_ms": 0.31791358556281935, "mean_env_wait_ms": 53.6381394376905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 55692, "timesteps_this_iter": 7956, "agent_timesteps_total": 55692, "timers": {"sample_time_ms": 39796.754, "sample_throughput": 199.916, "load_time_ms": 111.229, "load_throughput": 71528.321, "learn_time_ms": 24666.211, "learn_throughput": 322.547, "update_time_ms": 17.405}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.00010000000000000003, "total_loss": 261105.74592831518, "policy_loss": -0.12214894296941899, "vf_loss": 261105.8213243382, "vf_explained_var": 0.006764583946556173, "kl": 0.020635316423337668, "entropy": 1.5486362290959204, "entropy_coeff": 0.0}}}, "num_steps_sampled": 55692, "num_agent_steps_sampled": 55692, "num_steps_trained": 55692, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 55692}, "done": false, "episodes_total": 674, "training_iteration": 7, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-14-38", "timestamp": 1648646078, "time_this_iter_s": 42.288313150405884, "time_total_s": 303.1298143863678, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 303.1298143863678, "timesteps_since_restore": 55692, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 8.980327868852457, "ram_util_percent": 6.808196721311473}}
{"episode_reward_max": -866.4340712976972, "episode_reward_min": -1277.5586581701268, "episode_reward_mean": -1047.5885555186776, "episode_len_mean": 103.95, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-986.9549716212246, -1052.444315848529, -1076.76492204467, -1035.1661829454245, -1054.5305075578863, -1001.3803177136422, -1044.580214794909, -1045.3062855243663, -1061.0898392406507, -1023.6597238329401, -1124.7486548693125, -991.5016796855596, -1036.331099846543, -1115.9256598642457, -1011.3067202547691, -997.8218197300631, -975.7510744040374, -881.9254535759355, -1041.63298218701, -1046.4262416947606, -1057.23591572123, -1017.4669565772301, -1073.334070813134, -1119.212573901025, -1008.3724880823187, -1014.7905285231428, -1045.5985421734085, -1052.5473744832377, -1060.7299276471267, -1018.3760609631979, -1041.358378580139, -1048.5069682113517, -1063.7439758559372, -1037.4794071094063, -1047.390001515722, -1063.8299028301183, -1060.1556830339775, -1026.3398650173733, -921.4606031044154, -1050.0182222541498, -933.8929247245626, -1245.9505343893954, -1036.5642906517269, -992.442631310325, -1035.1309975357663, -1146.307105107077, -1041.7078109700492, -866.4340712976972, -1077.151462378721, -1121.397798419325, -996.0813706402221, -1009.4224417949505, -967.6581509039702, -1000.6181846297526, -981.4264424461957, -1060.6267003455087, -955.5576052523389, -1051.6306416172715, -1010.6439245931714, -1005.1935436545173, -1060.8330430066476, -1025.7158256342414, -1054.5201389141082, -1067.396962268007, -1277.5586581701268, -1088.5659758822646, -1075.017584691638, -1157.8833361571349, -1177.334793870757, -1107.6059744992758, -1098.2738165922337, -1053.471326527822, -1063.7570295987946, -1046.1054759456883, -1152.216827595615, -997.0382044205901, -1136.1868694756502, -1034.1857521832446, -1100.3512353457265, -1158.9804383039761, -1067.3254135944126, -1064.1114188823872, -1064.2735654665323, -1201.4978309832052, -1034.8575672815962, -1028.7052474278066, -1005.5212408200227, -1045.780063255634, -966.4918524738116, -1044.8736733508247, -1030.7537160232587, -1023.7932898744526, -1132.126634064613, -920.2863982309659, -1080.2719376655932, -1036.7120419222483, -1047.67374572524, -1057.2559136293944, -991.161284717863, -1013.3487010976847], "episode_lengths": [109, 48, 23, 95, 32, 139, 46, 56, 18, 97, 281, 68, 82, 104, 38, 59, 102, 140, 47, 50, 17, 432, 94, 141, 44, 57, 44, 60, 18, 81, 47, 54, 19, 177, 57, 19, 96, 113, 94, 49, 234, 392, 90, 229, 57, 197, 80, 212, 123, 103, 91, 92, 229, 90, 201, 18, 83, 108, 43, 51, 18, 50, 70, 84, 247, 223, 120, 234, 116, 145, 59, 51, 19, 101, 113, 82, 91, 70, 60, 181, 50, 19, 127, 111, 83, 139, 91, 45, 162, 44, 94, 184, 303, 225, 132, 77, 121, 17, 85, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3476680292799825, "mean_inference_ms": 10.494100262278925, "mean_action_processing_ms": 0.3167778912215565, "mean_env_wait_ms": 53.52298827158211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 63648, "timesteps_this_iter": 7956, "agent_timesteps_total": 63648, "timers": {"sample_time_ms": 40119.157, "sample_throughput": 198.309, "load_time_ms": 111.083, "load_throughput": 71622.408, "learn_time_ms": 24677.307, "learn_throughput": 322.401, "update_time_ms": 17.152}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 188325.27558111376, "policy_loss": -0.10658608371722361, "vf_loss": 188325.33574796288, "vf_explained_var": 0.04375219704002462, "kl": 0.01354506274194179, "entropy": 1.4408230547622969, "entropy_coeff": 0.0}}}, "num_steps_sampled": 63648, "num_agent_steps_sampled": 63648, "num_steps_trained": 63648, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 63648}, "done": false, "episodes_total": 734, "training_iteration": 8, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-15-21", "timestamp": 1648646121, "time_this_iter_s": 42.33832383155823, "time_total_s": 345.468138217926, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 345.468138217926, "timesteps_since_restore": 63648, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.203333333333331, "ram_util_percent": 6.844999999999997}}
{"episode_reward_max": -916.9961308851803, "episode_reward_min": -1277.5586581701268, "episode_reward_mean": -1065.8448298323788, "episode_len_mean": 117.54, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1025.7158256342414, -1054.5201389141082, -1067.396962268007, -1277.5586581701268, -1088.5659758822646, -1075.017584691638, -1157.8833361571349, -1177.334793870757, -1107.6059744992758, -1098.2738165922337, -1053.471326527822, -1063.7570295987946, -1046.1054759456883, -1152.216827595615, -997.0382044205901, -1136.1868694756502, -1034.1857521832446, -1100.3512353457265, -1158.9804383039761, -1067.3254135944126, -1064.1114188823872, -1064.2735654665323, -1201.4978309832052, -1034.8575672815962, -1028.7052474278066, -1005.5212408200227, -1045.780063255634, -966.4918524738116, -1044.8736733508247, -1030.7537160232587, -1023.7932898744526, -1132.126634064613, -920.2863982309659, -1080.2719376655932, -1036.7120419222483, -1047.67374572524, -1057.2559136293944, -991.161284717863, -1013.3487010976847, -1096.681019281826, -1087.6869457384341, -1054.5871503271148, -1057.3385052109365, -1029.3375175188062, -916.9961308851803, -1105.5531202264915, -1073.208432397379, -1076.198834983772, -1041.669067535278, -954.6257040945625, -1067.3684161711062, -1054.0655796838419, -1092.2426252937848, -1100.5310052407624, -1105.31571821929, -951.4373820111317, -1133.782432910401, -1114.9989052629687, -1077.217609914277, -1065.5760463086842, -1093.0112692773373, -1077.8313345507922, -1072.1974302440362, -921.6566061246226, -1132.235939407867, -1016.1919694087708, -1110.2999492684048, -1116.7148047577882, -1103.3164481331132, -998.2752841695697, -1000.2859566507226, -1057.2731286944954, -1001.6165399324391, -1039.8346663694178, -1055.0115751489238, -1122.011526234527, -1080.6024475306642, -1004.8046403473202, -1051.9839623081061, -985.1106624836336, -926.3301613920506, -1153.4325625665224, -1039.4035520264688, -1042.1574833758455, -1209.4047904982792, -1080.3452729036785, -1038.9055509027803, -1060.565210536502, -1095.3900086094077, -1114.8114747002255, -1060.4584259154467, -953.3467371349582, -1072.5010707749725, -1062.5752198565453, -1249.2461242635522, -1060.2824320084428, -1073.5794469283996, -1041.0053019449015, -1080.1838613185905, -1144.8862427572897], "episode_lengths": [50, 70, 84, 247, 223, 120, 234, 116, 145, 59, 51, 19, 101, 113, 82, 91, 70, 60, 181, 50, 19, 127, 111, 83, 139, 91, 45, 162, 44, 94, 184, 303, 225, 132, 77, 121, 17, 85, 82, 104, 65, 55, 17, 55, 208, 96, 59, 200, 115, 198, 38, 84, 138, 157, 35, 373, 105, 65, 102, 96, 61, 108, 234, 95, 96, 65, 91, 147, 201, 84, 156, 17, 94, 203, 33, 155, 110, 109, 54, 85, 95, 348, 152, 222, 358, 156, 115, 18, 95, 124, 77, 158, 81, 86, 322, 132, 43, 56, 87, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.169030313921141, "mean_inference_ms": 10.415722650276914, "mean_action_processing_ms": 0.3092506197421622, "mean_env_wait_ms": 53.549028948088996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 71604, "timesteps_this_iter": 7956, "agent_timesteps_total": 71604, "timers": {"sample_time_ms": 40347.222, "sample_throughput": 197.188, "load_time_ms": 110.934, "load_throughput": 71718.05, "learn_time_ms": 24682.801, "learn_throughput": 322.33, "update_time_ms": 16.604}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 169520.5487995763, "policy_loss": -0.10850414254412215, "vf_loss": 169520.61281587335, "vf_explained_var": 0.05760175412701022, "kl": 0.01309720558346401, "entropy": 1.4429887004436985, "entropy_coeff": 0.0}}}, "num_steps_sampled": 71604, "num_agent_steps_sampled": 71604, "num_steps_trained": 71604, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 71604}, "done": false, "episodes_total": 795, "training_iteration": 9, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-16-03", "timestamp": 1648646163, "time_this_iter_s": 42.07534074783325, "time_total_s": 387.5434789657593, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 387.5434789657593, "timesteps_since_restore": 71604, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.088333333333335, "ram_util_percent": 6.834999999999998}}
{"episode_reward_max": -912.7562291046562, "episode_reward_min": -1249.2461242635522, "episode_reward_mean": -1063.2540175354197, "episode_len_mean": 133.14, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1110.2999492684048, -1116.7148047577882, -1103.3164481331132, -998.2752841695697, -1000.2859566507226, -1057.2731286944954, -1001.6165399324391, -1039.8346663694178, -1055.0115751489238, -1122.011526234527, -1080.6024475306642, -1004.8046403473202, -1051.9839623081061, -985.1106624836336, -926.3301613920506, -1153.4325625665224, -1039.4035520264688, -1042.1574833758455, -1209.4047904982792, -1080.3452729036785, -1038.9055509027803, -1060.565210536502, -1095.3900086094077, -1114.8114747002255, -1060.4584259154467, -953.3467371349582, -1072.5010707749725, -1062.5752198565453, -1249.2461242635522, -1060.2824320084428, -1073.5794469283996, -1041.0053019449015, -1080.1838613185905, -1144.8862427572897, -1023.5143173723131, -1054.8988316543387, -1054.0668735649003, -958.6189593544825, -1074.9985613872886, -1043.0264354560675, -992.7080913860171, -981.967516935962, -1081.7833402935344, -1021.1320271914251, -957.5911447068775, -1139.0961448557223, -1153.2268426798134, -1086.7616124367428, -1237.4698761706268, -1100.1516889702539, -1057.0357017709791, -935.8221316116243, -1160.4665917922907, -1060.9936992259518, -977.452497708886, -984.2204381826244, -1110.3596902571805, -1046.1296736855163, -912.7562291046562, -987.9533654326844, -1087.1553326432331, -1079.7547090188086, -1033.5412730268104, -1043.3641483604642, -959.1258446680071, -1116.943163453086, -1109.0925202537956, -1162.8843200674808, -1068.0541003678416, -1069.8411112929048, -1053.7500272238105, -1039.6925328521704, -1085.8816859826459, -1067.8514059070383, -1176.0609163034244, -1056.6416448942452, -1068.1801434647625, -1138.6715152529544, -1063.3784479534095, -978.1472618269402, -968.885725825821, -1092.017592851159, -1044.7081738295492, -1031.9336975665424, -1166.0228180400734, -1225.0622850779514, -1053.4364698041395, -1077.0868635657134, -1045.7467386124276, -1210.010112204381, -1077.547028519717, -1080.0860761121007, -1039.12930092606, -1020.4070542004465, -1053.656972264285, -1076.263373719764, -995.9552350206994, -1038.824960146876, -1049.39563354806, -1041.058731259628], "episode_lengths": [91, 147, 201, 84, 156, 17, 94, 203, 33, 155, 110, 109, 54, 85, 95, 348, 152, 222, 358, 156, 115, 18, 95, 124, 77, 158, 81, 86, 322, 132, 43, 56, 87, 159, 205, 220, 105, 54, 96, 67, 108, 34, 53, 115, 61, 206, 103, 61, 525, 120, 17, 200, 100, 58, 117, 32, 103, 80, 487, 207, 163, 111, 128, 40, 104, 97, 63, 206, 104, 58, 123, 79, 96, 117, 714, 59, 207, 96, 57, 36, 342, 102, 65, 47, 229, 292, 96, 64, 102, 264, 194, 77, 46, 117, 16, 95, 138, 266, 96, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.059636201211716, "mean_inference_ms": 10.387397399315637, "mean_action_processing_ms": 0.3088217413448137, "mean_env_wait_ms": 53.57569423027309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 79560, "timesteps_this_iter": 7956, "agent_timesteps_total": 79560, "timers": {"sample_time_ms": 40533.285, "sample_throughput": 196.283, "load_time_ms": 110.693, "load_throughput": 71874.277, "learn_time_ms": 24688.478, "learn_throughput": 322.256, "update_time_ms": 16.036}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 169230.6763998052, "policy_loss": -0.10676998079864569, "vf_loss": 169230.73626348024, "vf_explained_var": 0.05145292176354316, "kl": 0.013537000334647675, "entropy": 1.4271102400556688, "entropy_coeff": 0.0}}}, "num_steps_sampled": 79560, "num_agent_steps_sampled": 79560, "num_steps_trained": 79560, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 79560}, "done": false, "episodes_total": 861, "training_iteration": 10, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-16-45", "timestamp": 1648646205, "time_this_iter_s": 42.15701079368591, "time_total_s": 429.7004897594452, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 429.7004897594452, "timesteps_since_restore": 79560, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 9.139999999999999, "ram_util_percent": 6.819999999999998}}
{"episode_reward_max": -912.7562291046562, "episode_reward_min": -1291.3480192844177, "episode_reward_mean": -1055.579518807756, "episode_len_mean": 136.79, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977.452497708886, -984.2204381826244, -1110.3596902571805, -1046.1296736855163, -912.7562291046562, -987.9533654326844, -1087.1553326432331, -1079.7547090188086, -1033.5412730268104, -1043.3641483604642, -959.1258446680071, -1116.943163453086, -1109.0925202537956, -1162.8843200674808, -1068.0541003678416, -1069.8411112929048, -1053.7500272238105, -1039.6925328521704, -1085.8816859826459, -1067.8514059070383, -1176.0609163034244, -1056.6416448942452, -1068.1801434647625, -1138.6715152529544, -1063.3784479534095, -978.1472618269402, -968.885725825821, -1092.017592851159, -1044.7081738295492, -1031.9336975665424, -1166.0228180400734, -1225.0622850779514, -1053.4364698041395, -1077.0868635657134, -1045.7467386124276, -1210.010112204381, -1077.547028519717, -1080.0860761121007, -1039.12930092606, -1020.4070542004465, -1053.656972264285, -1076.263373719764, -995.9552350206994, -1038.824960146876, -1049.39563354806, -1041.058731259628, -973.2971649763738, -1049.6694250422424, -1133.0661275232846, -1191.3291607632661, -1017.5870439381166, -1077.95495940023, -970.1605287637128, -1025.9326521230735, -1043.619982565594, -961.5685121278834, -968.6150860474552, -1040.8539919569423, -1132.4205945975093, -953.367562962665, -1061.9949012096713, -1059.4568685714005, -1137.901163885276, -1078.1285274202498, -1087.2974349660979, -981.49993780915, -1063.7569569881884, -1284.1587497586765, -1071.8181229390152, -946.0023203905797, -1095.1370558615988, -1001.2312300098605, -948.9683732591291, -1035.4969377838117, -1235.5758942964753, -1091.1169328061005, -956.925863542252, -983.2623870967058, -955.6644108474375, -914.302947849998, -1094.107387375378, -1027.5530179304233, -956.356900497671, -990.5229544715511, -1291.3480192844177, -1018.2676363235469, -1050.6673192179144, -1098.8305697497476, -967.9565581797171, -1105.4338815039193, -1105.7096027875966, -946.664094362376, -1173.4523412394224, -1001.5126694813794, -1103.8673980375347, -1062.375169584437, -991.9763813624758, -1064.0201460411618, -1076.1160205163317, -1037.9551604677952], "episode_lengths": [117, 32, 103, 80, 487, 207, 163, 111, 128, 40, 104, 97, 63, 206, 104, 58, 123, 79, 96, 117, 714, 59, 207, 96, 57, 36, 342, 102, 65, 47, 229, 292, 96, 64, 102, 264, 194, 77, 46, 117, 16, 95, 138, 266, 96, 51, 179, 174, 159, 219, 117, 85, 107, 99, 67, 147, 61, 110, 240, 274, 53, 81, 105, 57, 103, 32, 280, 424, 114, 79, 94, 125, 69, 118, 208, 265, 231, 84, 92, 98, 140, 193, 71, 135, 285, 89, 194, 76, 42, 94, 106, 95, 253, 230, 98, 60, 93, 84, 103, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9794511781090227, "mean_inference_ms": 10.368516495625075, "mean_action_processing_ms": 0.31373630111920314, "mean_env_wait_ms": 53.629639262312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 87516, "timesteps_this_iter": 7956, "agent_timesteps_total": 87516, "timers": {"sample_time_ms": 42673.846, "sample_throughput": 186.437, "load_time_ms": 110.584, "load_throughput": 71945.419, "learn_time_ms": 24723.394, "learn_throughput": 321.8, "update_time_ms": 14.591}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 147826.9552702668, "policy_loss": -0.1099590987968509, "vf_loss": 147827.02054321946, "vf_explained_var": 0.03774729428752776, "kl": 0.013084821796436857, "entropy": 1.275661593451295, "entropy_coeff": 0.0}}}, "num_steps_sampled": 87516, "num_agent_steps_sampled": 87516, "num_steps_trained": 87516, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 87516}, "done": false, "episodes_total": 915, "training_iteration": 11, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-17-28", "timestamp": 1648646248, "time_this_iter_s": 42.490564823150635, "time_total_s": 472.1910545825958, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 472.1910545825958, "timesteps_since_restore": 87516, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 9.156666666666666, "ram_util_percent": 6.829999999999998}}
{"episode_reward_max": -828.3378962021043, "episode_reward_min": -1291.3480192844177, "episode_reward_mean": -1054.2839805624635, "episode_len_mean": 140.41, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-961.5685121278834, -968.6150860474552, -1040.8539919569423, -1132.4205945975093, -953.367562962665, -1061.9949012096713, -1059.4568685714005, -1137.901163885276, -1078.1285274202498, -1087.2974349660979, -981.49993780915, -1063.7569569881884, -1284.1587497586765, -1071.8181229390152, -946.0023203905797, -1095.1370558615988, -1001.2312300098605, -948.9683732591291, -1035.4969377838117, -1235.5758942964753, -1091.1169328061005, -956.925863542252, -983.2623870967058, -955.6644108474375, -914.302947849998, -1094.107387375378, -1027.5530179304233, -956.356900497671, -990.5229544715511, -1291.3480192844177, -1018.2676363235469, -1050.6673192179144, -1098.8305697497476, -967.9565581797171, -1105.4338815039193, -1105.7096027875966, -946.664094362376, -1173.4523412394224, -1001.5126694813794, -1103.8673980375347, -1062.375169584437, -991.9763813624758, -1064.0201460411618, -1076.1160205163317, -1037.9551604677952, -1099.4144102354376, -1084.5609501145052, -1097.0263699826573, -991.7195802997038, -980.9367083492847, -1120.420004618595, -1153.5514812378835, -1107.7777863363897, -828.3378962021043, -1122.320740305828, -1071.1012737747071, -1214.2192780080882, -1143.4765609536814, -927.2397363125208, -991.2003702455319, -944.7094124575096, -962.2142673202475, -985.5699016316754, -1052.7061758953153, -1000.833511412233, -1047.7221383110111, -1013.5258953171659, -988.7674118505529, -1015.8265659862657, -1067.3326077226245, -987.2450701116863, -1152.8522808186358, -988.914017463584, -1126.6853791120884, -1079.5960398348539, -1183.0854628990642, -1188.644660059922, -982.6027769668412, -960.2501730017773, -1085.630049382388, -1241.9395455034257, -1103.1028771595763, -1084.9980260790671, -1030.2518840938258, -1140.1583949766832, -1106.6029456122812, -982.683491870016, -986.4722206392119, -1043.2350592949228, -1082.122679930787, -1078.7707806347796, -1103.4298317655803, -1036.7239911411489, -1125.2142994212816, -1138.6984124584096, -1129.2809600692995, -978.1399466801997, -1010.7786987139527, -944.5953137313425, -1121.9657585392504], "episode_lengths": [147, 61, 110, 240, 274, 53, 81, 105, 57, 103, 32, 280, 424, 114, 79, 94, 125, 69, 118, 208, 265, 231, 84, 92, 98, 140, 193, 71, 135, 285, 89, 194, 76, 42, 94, 106, 95, 253, 230, 98, 60, 93, 84, 103, 105, 341, 82, 59, 72, 33, 191, 379, 342, 328, 293, 147, 201, 79, 121, 24, 71, 110, 29, 101, 229, 42, 104, 26, 313, 304, 28, 164, 378, 100, 63, 223, 258, 107, 95, 165, 186, 142, 186, 66, 102, 71, 33, 69, 22, 122, 229, 161, 99, 64, 223, 114, 150, 48, 91, 171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.881576616382116, "mean_inference_ms": 10.336236501684489, "mean_action_processing_ms": 0.31791108588256156, "mean_env_wait_ms": 53.70643538127576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 95472, "timesteps_this_iter": 7956, "agent_timesteps_total": 95472, "timers": {"sample_time_ms": 42518.963, "sample_throughput": 187.117, "load_time_ms": 110.286, "load_throughput": 72139.789, "learn_time_ms": 24720.306, "learn_throughput": 321.841, "update_time_ms": 22.438}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 134103.62578456427, "policy_loss": -0.10760941402786361, "vf_loss": 134103.68708005516, "vf_explained_var": 0.06721430561875784, "kl": 0.013512572002445707, "entropy": 1.3368696137141156, "entropy_coeff": 0.0}}}, "num_steps_sampled": 95472, "num_agent_steps_sampled": 95472, "num_steps_trained": 95472, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 95472}, "done": false, "episodes_total": 970, "training_iteration": 12, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-18-11", "timestamp": 1648646291, "time_this_iter_s": 42.72136092185974, "time_total_s": 514.9124155044556, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 514.9124155044556, "timesteps_since_restore": 95472, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.43114754098361, "ram_util_percent": 6.834426229508195}}
{"episode_reward_max": -904.0293240231176, "episode_reward_min": -1362.4407996835293, "episode_reward_mean": -1054.4784972964526, "episode_len_mean": 136.9, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1143.4765609536814, -927.2397363125208, -991.2003702455319, -944.7094124575096, -962.2142673202475, -985.5699016316754, -1052.7061758953153, -1000.833511412233, -1047.7221383110111, -1013.5258953171659, -988.7674118505529, -1015.8265659862657, -1067.3326077226245, -987.2450701116863, -1152.8522808186358, -988.914017463584, -1126.6853791120884, -1079.5960398348539, -1183.0854628990642, -1188.644660059922, -982.6027769668412, -960.2501730017773, -1085.630049382388, -1241.9395455034257, -1103.1028771595763, -1084.9980260790671, -1030.2518840938258, -1140.1583949766832, -1106.6029456122812, -982.683491870016, -986.4722206392119, -1043.2350592949228, -1082.122679930787, -1078.7707806347796, -1103.4298317655803, -1036.7239911411489, -1125.2142994212816, -1138.6984124584096, -1129.2809600692995, -978.1399466801997, -1010.7786987139527, -944.5953137313425, -1121.9657585392504, -1033.6943343792593, -1016.3361944618207, -1058.7464717557982, -1007.9457082024712, -989.5109376000532, -961.0236697484601, -1130.3863324484266, -1015.1902796625233, -1152.8332200775674, -1078.8956685104458, -921.7051936273717, -1021.2367287392898, -1068.3308743577404, -1075.0620977773185, -1098.9534297279738, -1063.7709527381367, -1070.9709580959664, -985.9329835464467, -952.2208663930609, -1079.813792616211, -1138.5144095554117, -983.60396164241, -1082.6039742906685, -947.4160058846551, -1118.709687042734, -1023.5688674637564, -1145.5442957363575, -1013.6476832870475, -953.8643934677252, -1201.1000268575744, -946.3391863998916, -1252.046364733213, -1362.4407996835293, -1002.6834833120643, -1035.8395441113898, -935.1274716945559, -1343.4912408063863, -1106.4209198238661, -1083.2708162550894, -904.0293240231176, -988.159837398327, -1057.0512568619208, -969.0700249432933, -1096.4094489618947, -1104.3662236799967, -913.7939456783065, -1147.747415069293, -980.3822303186957, -1083.6169002659803, -976.5507925625878, -986.0562927514729, -1157.4389291290654, -1062.5101786738298, -1061.504524659846, -1067.3336715358018, -1080.894515305029, -1006.344807929919], "episode_lengths": [79, 121, 24, 71, 110, 29, 101, 229, 42, 104, 26, 313, 304, 28, 164, 378, 100, 63, 223, 258, 107, 95, 165, 186, 142, 186, 66, 102, 71, 33, 69, 22, 122, 229, 161, 99, 64, 223, 114, 150, 48, 91, 171, 71, 144, 116, 80, 26, 72, 72, 131, 180, 141, 125, 159, 116, 57, 90, 61, 62, 89, 80, 433, 93, 112, 166, 77, 82, 108, 341, 61, 357, 97, 96, 168, 464, 242, 106, 99, 425, 278, 102, 130, 28, 106, 42, 167, 172, 191, 234, 36, 59, 101, 29, 152, 98, 58, 126, 502, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8113424306833164, "mean_inference_ms": 10.309414550004348, "mean_action_processing_ms": 0.31370195031267845, "mean_env_wait_ms": 53.668030201389335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 103428, "timesteps_this_iter": 7956, "agent_timesteps_total": 103428, "timers": {"sample_time_ms": 42455.582, "sample_throughput": 187.396, "load_time_ms": 110.192, "load_throughput": 72201.193, "learn_time_ms": 24728.064, "learn_throughput": 321.74, "update_time_ms": 22.544}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 142347.23582565144, "policy_loss": -0.11306398240749234, "vf_loss": 142347.30242178313, "vf_explained_var": 0.06419509783867866, "kl": 0.013529135690443764, "entropy": 1.287183407814272, "entropy_coeff": 0.0}}}, "num_steps_sampled": 103428, "num_agent_steps_sampled": 103428, "num_steps_trained": 103428, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 103428}, "done": false, "episodes_total": 1027, "training_iteration": 13, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-18-53", "timestamp": 1648646333, "time_this_iter_s": 42.0696177482605, "time_total_s": 556.9820332527161, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 556.9820332527161, "timesteps_since_restore": 103428, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 9.215000000000002, "ram_util_percent": 6.828333333333332}}
{"episode_reward_max": -904.0293240231176, "episode_reward_min": -1362.4407996835293, "episode_reward_mean": -1045.8315603384606, "episode_len_mean": 142.09, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121.9657585392504, -1033.6943343792593, -1016.3361944618207, -1058.7464717557982, -1007.9457082024712, -989.5109376000532, -961.0236697484601, -1130.3863324484266, -1015.1902796625233, -1152.8332200775674, -1078.8956685104458, -921.7051936273717, -1021.2367287392898, -1068.3308743577404, -1075.0620977773185, -1098.9534297279738, -1063.7709527381367, -1070.9709580959664, -985.9329835464467, -952.2208663930609, -1079.813792616211, -1138.5144095554117, -983.60396164241, -1082.6039742906685, -947.4160058846551, -1118.709687042734, -1023.5688674637564, -1145.5442957363575, -1013.6476832870475, -953.8643934677252, -1201.1000268575744, -946.3391863998916, -1252.046364733213, -1362.4407996835293, -1002.6834833120643, -1035.8395441113898, -935.1274716945559, -1343.4912408063863, -1106.4209198238661, -1083.2708162550894, -904.0293240231176, -988.159837398327, -1057.0512568619208, -969.0700249432933, -1096.4094489618947, -1104.3662236799967, -913.7939456783065, -1147.747415069293, -980.3822303186957, -1083.6169002659803, -976.5507925625878, -986.0562927514729, -1157.4389291290654, -1062.5101786738298, -1061.504524659846, -1067.3336715358018, -1080.894515305029, -1006.344807929919, -919.2754968036837, -1027.0336795972528, -1022.8507415881575, -976.6674377363835, -915.8355305812228, -1009.6662389230124, -977.0317766089248, -1111.670886020058, -1019.2632493694607, -1131.5834662509938, -942.5689836801319, -990.1274764317934, -1191.425651587159, -958.0778216955284, -974.0912740000957, -1025.7615072873646, -1045.686646376056, -1001.6499705321827, -1086.5858524825896, -1035.499712650396, -1081.942281845495, -1157.3434611030227, -1038.493131859895, -997.3972979244749, -1043.3056766590041, -989.3975170226443, -967.4802836132565, -1036.5358756425012, -984.339242796035, -1042.180425928551, -1060.959474296478, -988.8913582074009, -1095.9681577688916, -942.4428122203255, -1071.0543162957683, -1328.2780504159182, -1097.7929416214308, -1090.2185282830435, -933.2566185020664, -1112.6783987119154, -958.4613045180266, -978.365573605153], "episode_lengths": [171, 71, 144, 116, 80, 26, 72, 72, 131, 180, 141, 125, 159, 116, 57, 90, 61, 62, 89, 80, 433, 93, 112, 166, 77, 82, 108, 341, 61, 357, 97, 96, 168, 464, 242, 106, 99, 425, 278, 102, 130, 28, 106, 42, 167, 172, 191, 234, 36, 59, 101, 29, 152, 98, 58, 126, 502, 197, 121, 121, 77, 41, 94, 50, 39, 164, 60, 203, 108, 24, 191, 117, 108, 69, 41, 110, 101, 121, 196, 300, 152, 292, 417, 23, 67, 19, 69, 22, 109, 108, 295, 116, 249, 465, 144, 106, 95, 209, 364, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.714191436798304, "mean_inference_ms": 10.317830926815798, "mean_action_processing_ms": 0.31091686810551133, "mean_env_wait_ms": 53.71100037884038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 111384, "timesteps_this_iter": 7956, "agent_timesteps_total": 111384, "timers": {"sample_time_ms": 42372.829, "sample_throughput": 187.762, "load_time_ms": 110.3, "load_throughput": 72130.776, "learn_time_ms": 24737.61, "learn_throughput": 321.616, "update_time_ms": 22.412}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 97805.17757584767, "policy_loss": -0.10559095307754013, "vf_loss": 97805.23991873136, "vf_explained_var": 0.014980475748738935, "kl": 0.012580606483446609, "entropy": 1.1944174000973342, "entropy_coeff": 0.0}}}, "num_steps_sampled": 111384, "num_agent_steps_sampled": 111384, "num_steps_trained": 111384, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 111384}, "done": false, "episodes_total": 1069, "training_iteration": 14, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-19-35", "timestamp": 1648646375, "time_this_iter_s": 42.35457992553711, "time_total_s": 599.3366131782532, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 599.3366131782532, "timesteps_since_restore": 111384, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 9.261666666666667, "ram_util_percent": 6.841666666666665}}
{"episode_reward_max": -911.3111218756507, "episode_reward_min": -1328.2780504159182, "episode_reward_mean": -1051.864430945547, "episode_len_mean": 167.05, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-913.7939456783065, -1147.747415069293, -980.3822303186957, -1083.6169002659803, -976.5507925625878, -986.0562927514729, -1157.4389291290654, -1062.5101786738298, -1061.504524659846, -1067.3336715358018, -1080.894515305029, -1006.344807929919, -919.2754968036837, -1027.0336795972528, -1022.8507415881575, -976.6674377363835, -915.8355305812228, -1009.6662389230124, -977.0317766089248, -1111.670886020058, -1019.2632493694607, -1131.5834662509938, -942.5689836801319, -990.1274764317934, -1191.425651587159, -958.0778216955284, -974.0912740000957, -1025.7615072873646, -1045.686646376056, -1001.6499705321827, -1086.5858524825896, -1035.499712650396, -1081.942281845495, -1157.3434611030227, -1038.493131859895, -997.3972979244749, -1043.3056766590041, -989.3975170226443, -967.4802836132565, -1036.5358756425012, -984.339242796035, -1042.180425928551, -1060.959474296478, -988.8913582074009, -1095.9681577688916, -942.4428122203255, -1071.0543162957683, -1328.2780504159182, -1097.7929416214308, -1090.2185282830435, -933.2566185020664, -1112.6783987119154, -958.4613045180266, -978.365573605153, -1165.746622663734, -965.4966141193171, -1041.885554782814, -1101.5043896355544, -1088.527046224964, -1038.853980614808, -942.5456493728545, -1188.1629103123375, -1132.2972682462814, -1020.3970050120832, -969.2349995821669, -1132.3864772006061, -1017.0531708711146, -1093.1962362603958, -1079.7510399841506, -1113.1395219177173, -1308.5743583946637, -1010.7300908448643, -993.9904926538806, -1131.273996541777, -1050.92899587182, -984.2977043140446, -1041.932922991456, -1025.3087415725365, -1112.3208051686772, -1227.2101912136636, -973.9463452401371, -1103.668018742409, -1099.2417820514536, -1086.0124256721344, -1259.390885987012, -980.0577734438885, -911.3111218756507, -1124.5801707348905, -1045.2747979195728, -955.4753810636063, -1051.387536033137, -1123.9373237393888, -985.5800604641101, -1234.138289747414, -1019.7182888100554, -935.1430190929, -1095.127455126419, -993.2500734083784, -1206.749882443059, -1142.395343667217], "episode_lengths": [191, 234, 36, 59, 101, 29, 152, 98, 58, 126, 502, 197, 121, 121, 77, 41, 94, 50, 39, 164, 60, 203, 108, 24, 191, 117, 108, 69, 41, 110, 101, 121, 196, 300, 152, 292, 417, 23, 67, 19, 69, 22, 109, 108, 295, 116, 249, 465, 144, 106, 95, 209, 364, 54, 319, 87, 21, 452, 291, 263, 76, 449, 231, 65, 67, 88, 75, 355, 145, 561, 349, 193, 246, 121, 172, 69, 263, 66, 176, 371, 114, 165, 94, 55, 693, 37, 107, 132, 82, 85, 297, 335, 84, 255, 67, 112, 157, 31, 416, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.601226364687607, "mean_inference_ms": 10.330715744234835, "mean_action_processing_ms": 0.3107298431572808, "mean_env_wait_ms": 53.7877497865776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 119340, "timesteps_this_iter": 7956, "agent_timesteps_total": 119340, "timers": {"sample_time_ms": 42420.126, "sample_throughput": 187.552, "load_time_ms": 110.345, "load_throughput": 72100.884, "learn_time_ms": 24741.706, "learn_throughput": 321.562, "update_time_ms": 21.422}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 108657.15977914461, "policy_loss": -0.1122801991480012, "vf_loss": 108657.22675118395, "vf_explained_var": 0.04487402445526533, "kl": 0.013279405224845229, "entropy": 1.2303956298417942, "entropy_coeff": 0.0}}}, "num_steps_sampled": 119340, "num_agent_steps_sampled": 119340, "num_steps_trained": 119340, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 119340}, "done": false, "episodes_total": 1115, "training_iteration": 15, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-20-18", "timestamp": 1648646418, "time_this_iter_s": 42.8793249130249, "time_total_s": 642.2159380912781, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 642.2159380912781, "timesteps_since_restore": 119340, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 9.044262295081968, "ram_util_percent": 6.767213114754099}}
{"episode_reward_max": -911.3111218756507, "episode_reward_min": -1328.2780504159182, "episode_reward_mean": -1063.2269773266046, "episode_len_mean": 174.87, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942.4428122203255, -1071.0543162957683, -1328.2780504159182, -1097.7929416214308, -1090.2185282830435, -933.2566185020664, -1112.6783987119154, -958.4613045180266, -978.365573605153, -1165.746622663734, -965.4966141193171, -1041.885554782814, -1101.5043896355544, -1088.527046224964, -1038.853980614808, -942.5456493728545, -1188.1629103123375, -1132.2972682462814, -1020.3970050120832, -969.2349995821669, -1132.3864772006061, -1017.0531708711146, -1093.1962362603958, -1079.7510399841506, -1113.1395219177173, -1308.5743583946637, -1010.7300908448643, -993.9904926538806, -1131.273996541777, -1050.92899587182, -984.2977043140446, -1041.932922991456, -1025.3087415725365, -1112.3208051686772, -1227.2101912136636, -973.9463452401371, -1103.668018742409, -1099.2417820514536, -1086.0124256721344, -1259.390885987012, -980.0577734438885, -911.3111218756507, -1124.5801707348905, -1045.2747979195728, -955.4753810636063, -1051.387536033137, -1123.9373237393888, -985.5800604641101, -1234.138289747414, -1019.7182888100554, -935.1430190929, -1095.127455126419, -993.2500734083784, -1206.749882443059, -1142.395343667217, -1029.6185986961464, -1105.4654192540904, -992.9127013165197, -1121.9321828769705, -950.0308691723418, -1222.5969621243828, -954.9211405114058, -951.6637504976484, -982.0934403156493, -986.1876064621152, -976.5693248305677, -1034.93958704936, -939.2689337098651, -1085.1134225684623, -1040.9266085941135, -1036.1870762965907, -1153.323138942758, -1024.0475682982653, -1046.6712635483814, -1021.9924577701785, -948.320596394223, -1122.110707073205, -1065.452669873782, -997.2189834988677, -950.1302303459362, -1079.716321154278, -972.3186383915223, -1024.321102897895, -1151.0670556552473, -1154.8695005131985, -970.7021133687606, -1022.8302942335428, -1071.7592687771714, -1304.5807920769234, -1180.2335449521988, -1069.126003705754, -921.2652783919095, -1124.7183500823933, -1095.9242732876207, -1214.872809331957, -1301.6547672617073, -1056.8609292795165, -1063.1591593096177, -988.333464449046, -999.0075197136244], "episode_lengths": [116, 249, 465, 144, 106, 95, 209, 364, 54, 319, 87, 21, 452, 291, 263, 76, 449, 231, 65, 67, 88, 75, 355, 145, 561, 349, 193, 246, 121, 172, 69, 263, 66, 176, 371, 114, 165, 94, 55, 693, 37, 107, 132, 82, 85, 297, 335, 84, 255, 67, 112, 157, 31, 416, 202, 66, 102, 84, 82, 101, 367, 63, 94, 80, 28, 43, 18, 100, 182, 120, 120, 126, 126, 191, 46, 89, 90, 117, 84, 80, 40, 111, 111, 120, 193, 70, 243, 431, 213, 293, 108, 110, 339, 448, 198, 473, 78, 122, 28, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5653827876602975, "mean_inference_ms": 10.305999450230386, "mean_action_processing_ms": 0.31189258578871926, "mean_env_wait_ms": 53.758768572565906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 127296, "timesteps_this_iter": 7956, "agent_timesteps_total": 127296, "timers": {"sample_time_ms": 42385.11, "sample_throughput": 187.707, "load_time_ms": 110.414, "load_throughput": 72055.906, "learn_time_ms": 24743.475, "learn_throughput": 321.539, "update_time_ms": 21.592}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 95496.92190709268, "policy_loss": -0.11326176963586321, "vf_loss": 95496.98948802333, "vf_explained_var": 0.11376512008969501, "kl": 0.013363264122406675, "entropy": 1.1632095993045837, "entropy_coeff": 0.0}}}, "num_steps_sampled": 127296, "num_agent_steps_sampled": 127296, "num_steps_trained": 127296, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 127296}, "done": false, "episodes_total": 1160, "training_iteration": 16, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-21-00", "timestamp": 1648646460, "time_this_iter_s": 41.865447998046875, "time_total_s": 684.081386089325, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 684.081386089325, "timesteps_since_restore": 127296, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 9.118333333333334, "ram_util_percent": 6.819999999999998}}
{"episode_reward_max": -862.254046346547, "episode_reward_min": -1304.5807920769234, "episode_reward_mean": -1049.741164691926, "episode_len_mean": 169.52, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-911.3111218756507, -1124.5801707348905, -1045.2747979195728, -955.4753810636063, -1051.387536033137, -1123.9373237393888, -985.5800604641101, -1234.138289747414, -1019.7182888100554, -935.1430190929, -1095.127455126419, -993.2500734083784, -1206.749882443059, -1142.395343667217, -1029.6185986961464, -1105.4654192540904, -992.9127013165197, -1121.9321828769705, -950.0308691723418, -1222.5969621243828, -954.9211405114058, -951.6637504976484, -982.0934403156493, -986.1876064621152, -976.5693248305677, -1034.93958704936, -939.2689337098651, -1085.1134225684623, -1040.9266085941135, -1036.1870762965907, -1153.323138942758, -1024.0475682982653, -1046.6712635483814, -1021.9924577701785, -948.320596394223, -1122.110707073205, -1065.452669873782, -997.2189834988677, -950.1302303459362, -1079.716321154278, -972.3186383915223, -1024.321102897895, -1151.0670556552473, -1154.8695005131985, -970.7021133687606, -1022.8302942335428, -1071.7592687771714, -1304.5807920769234, -1180.2335449521988, -1069.126003705754, -921.2652783919095, -1124.7183500823933, -1095.9242732876207, -1214.872809331957, -1301.6547672617073, -1056.8609292795165, -1063.1591593096177, -988.333464449046, -999.0075197136244, -1124.03444574665, -1069.3244156318453, -1143.0648609097254, -932.8892334845484, -1138.1456123515663, -937.5112919720332, -1034.4818096848096, -937.4354475177847, -1002.4241752820491, -1129.8936807226814, -991.3415418909557, -1098.4066693345108, -1012.9945717075096, -993.9047958960299, -999.4502656777223, -989.2308773800028, -1088.5691499635873, -1243.7715289127502, -1093.767625530902, -928.2321835809364, -1002.9065601438081, -1185.8048377330445, -1016.1777227498824, -862.254046346547, -1100.8679034416457, -1196.454379192742, -971.673702355679, -924.3224540503134, -990.8636460754961, -970.2739064830662, -1064.6589403218343, -1094.6876478509503, -986.5509619877738, -1085.03116147147, -1091.9583679943896, -992.5107290458768, -1035.823447869894, -1024.5779451735602, -1108.3793167576564, -1079.4259159600697, -968.9535220268068], "episode_lengths": [107, 132, 82, 85, 297, 335, 84, 255, 67, 112, 157, 31, 416, 202, 66, 102, 84, 82, 101, 367, 63, 94, 80, 28, 43, 18, 100, 182, 120, 120, 126, 126, 191, 46, 89, 90, 117, 84, 80, 40, 111, 111, 120, 193, 70, 243, 431, 213, 293, 108, 110, 339, 448, 198, 473, 78, 122, 28, 266, 174, 185, 185, 101, 574, 108, 52, 99, 155, 274, 22, 150, 293, 21, 569, 72, 85, 373, 87, 111, 127, 154, 152, 326, 92, 182, 147, 377, 586, 71, 417, 113, 29, 293, 478, 66, 105, 263, 88, 44, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4845988822261416, "mean_inference_ms": 10.305073914875315, "mean_action_processing_ms": 0.3139222816896621, "mean_env_wait_ms": 53.736333795234316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 135252, "timesteps_this_iter": 7956, "agent_timesteps_total": 135252, "timers": {"sample_time_ms": 42343.98, "sample_throughput": 187.89, "load_time_ms": 110.236, "load_throughput": 72172.289, "learn_time_ms": 24740.76, "learn_throughput": 321.575, "update_time_ms": 21.232}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 73019.67079635127, "policy_loss": -0.10982951577827935, "vf_loss": 73019.73561258624, "vf_explained_var": 0.20497952010682835, "kl": 0.013137814207870191, "entropy": 1.1554106638316186, "entropy_coeff": 0.0}}}, "num_steps_sampled": 135252, "num_agent_steps_sampled": 135252, "num_steps_trained": 135252, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 135252}, "done": false, "episodes_total": 1201, "training_iteration": 17, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-21-42", "timestamp": 1648646502, "time_this_iter_s": 41.82005500793457, "time_total_s": 725.9014410972595, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 725.9014410972595, "timesteps_since_restore": 135252, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 5.745762711864405, "ram_util_percent": 5.835593220338982}}
{"episode_reward_max": -836.3562214112251, "episode_reward_min": -1316.0166425836587, "episode_reward_mean": -1052.6495481708034, "episode_len_mean": 195.39, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1040.9266085941135, -1036.1870762965907, -1153.323138942758, -1024.0475682982653, -1046.6712635483814, -1021.9924577701785, -948.320596394223, -1122.110707073205, -1065.452669873782, -997.2189834988677, -950.1302303459362, -1079.716321154278, -972.3186383915223, -1024.321102897895, -1151.0670556552473, -1154.8695005131985, -970.7021133687606, -1022.8302942335428, -1071.7592687771714, -1304.5807920769234, -1180.2335449521988, -1069.126003705754, -921.2652783919095, -1124.7183500823933, -1095.9242732876207, -1214.872809331957, -1301.6547672617073, -1056.8609292795165, -1063.1591593096177, -988.333464449046, -999.0075197136244, -1124.03444574665, -1069.3244156318453, -1143.0648609097254, -932.8892334845484, -1138.1456123515663, -937.5112919720332, -1034.4818096848096, -937.4354475177847, -1002.4241752820491, -1129.8936807226814, -991.3415418909557, -1098.4066693345108, -1012.9945717075096, -993.9047958960299, -999.4502656777223, -989.2308773800028, -1088.5691499635873, -1243.7715289127502, -1093.767625530902, -928.2321835809364, -1002.9065601438081, -1185.8048377330445, -1016.1777227498824, -862.254046346547, -1100.8679034416457, -1196.454379192742, -971.673702355679, -924.3224540503134, -990.8636460754961, -970.2739064830662, -1064.6589403218343, -1094.6876478509503, -986.5509619877738, -1085.03116147147, -1091.9583679943896, -992.5107290458768, -1035.823447869894, -1024.5779451735602, -1108.3793167576564, -1079.4259159600697, -968.9535220268068, -969.3036947292678, -1316.0166425836587, -1187.7504071713781, -1013.6551185498091, -1031.7378942374403, -1113.3667540675017, -960.4376442620633, -1056.3663782987314, -1106.3297995778223, -836.3562214112251, -1161.5292470354732, -1034.332265835668, -1073.5452384421667, -986.2028685708592, -1091.675368235312, -991.6754027318082, -1009.3083496193502, -1088.8979554378227, -975.0762620058407, -1155.6765304964713, -945.902942051341, -1044.601917242367, -1057.099269890147, -1015.314418116559, -1039.348993562121, -1111.1280617052064, -1060.4931846288875, -1015.0922009027554], "episode_lengths": [120, 120, 126, 126, 191, 46, 89, 90, 117, 84, 80, 40, 111, 111, 120, 193, 70, 243, 431, 213, 293, 108, 110, 339, 448, 198, 473, 78, 122, 28, 266, 174, 185, 185, 101, 574, 108, 52, 99, 155, 274, 22, 150, 293, 21, 569, 72, 85, 373, 87, 111, 127, 154, 152, 326, 92, 182, 147, 377, 586, 71, 417, 113, 29, 293, 478, 66, 105, 263, 88, 44, 196, 149, 729, 377, 359, 380, 180, 70, 270, 88, 380, 353, 290, 219, 61, 147, 23, 85, 543, 384, 87, 72, 22, 123, 56, 177, 434, 209, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3819924926956797, "mean_inference_ms": 10.296070802829004, "mean_action_processing_ms": 0.3133412271513206, "mean_env_wait_ms": 53.73673929303319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 143208, "timesteps_this_iter": 7956, "agent_timesteps_total": 143208, "timers": {"sample_time_ms": 42264.989, "sample_throughput": 188.241, "load_time_ms": 110.126, "load_throughput": 72244.57, "learn_time_ms": 24734.723, "learn_throughput": 321.653, "update_time_ms": 20.611}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 53895.925144745204, "policy_loss": -0.10018236299986721, "vf_loss": 53895.98444794686, "vf_explained_var": -0.04002607371858371, "kl": 0.011929700654724944, "entropy": 1.1678185741427125, "entropy_coeff": 0.0}}}, "num_steps_sampled": 143208, "num_agent_steps_sampled": 143208, "num_steps_trained": 143208, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 143208}, "done": false, "episodes_total": 1229, "training_iteration": 18, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-22-23", "timestamp": 1648646543, "time_this_iter_s": 41.504920959472656, "time_total_s": 767.4063620567322, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 767.4063620567322, "timesteps_since_restore": 143208, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 7.998333333333333, "ram_util_percent": 6.3100000000000005}}
{"episode_reward_max": -836.3562214112251, "episode_reward_min": -1374.7714128312375, "episode_reward_mean": -1048.6771903510632, "episode_len_mean": 211.43, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.5112919720332, -1034.4818096848096, -937.4354475177847, -1002.4241752820491, -1129.8936807226814, -991.3415418909557, -1098.4066693345108, -1012.9945717075096, -993.9047958960299, -999.4502656777223, -989.2308773800028, -1088.5691499635873, -1243.7715289127502, -1093.767625530902, -928.2321835809364, -1002.9065601438081, -1185.8048377330445, -1016.1777227498824, -862.254046346547, -1100.8679034416457, -1196.454379192742, -971.673702355679, -924.3224540503134, -990.8636460754961, -970.2739064830662, -1064.6589403218343, -1094.6876478509503, -986.5509619877738, -1085.03116147147, -1091.9583679943896, -992.5107290458768, -1035.823447869894, -1024.5779451735602, -1108.3793167576564, -1079.4259159600697, -968.9535220268068, -969.3036947292678, -1316.0166425836587, -1187.7504071713781, -1013.6551185498091, -1031.7378942374403, -1113.3667540675017, -960.4376442620633, -1056.3663782987314, -1106.3297995778223, -836.3562214112251, -1161.5292470354732, -1034.332265835668, -1073.5452384421667, -986.2028685708592, -1091.675368235312, -991.6754027318082, -1009.3083496193502, -1088.8979554378227, -975.0762620058407, -1155.6765304964713, -945.902942051341, -1044.601917242367, -1057.099269890147, -1015.314418116559, -1039.348993562121, -1111.1280617052064, -1060.4931846288875, -1015.0922009027554, -1040.1624298599177, -1026.2218752108308, -1114.8479726902779, -990.3733342134689, -1063.5396286572611, -1117.832469189775, -1216.0892392047758, -993.955923899809, -1022.6095929614924, -937.7996480403131, -1042.8218786771713, -1078.9691681037623, -980.4164156554749, -1132.5240890274, -1220.4155870202171, -981.0053526620516, -1022.7841110931664, -934.0967155971183, -1120.1025619206887, -939.7663791134122, -1131.9360682834758, -1075.3543119793258, -1080.3682643584607, -1098.7156565959663, -963.9114995754496, -1025.3854017632884, -972.7482922200114, -1009.564825611642, -1109.759491099725, -976.732241682152, -1118.3556714915028, -1374.7714128312375, -1010.1885647244967, -1049.945082239887, -1035.5561700859573, -1174.297946279549], "episode_lengths": [108, 52, 99, 155, 274, 22, 150, 293, 21, 569, 72, 85, 373, 87, 111, 127, 154, 152, 326, 92, 182, 147, 377, 586, 71, 417, 113, 29, 293, 478, 66, 105, 263, 88, 44, 196, 149, 729, 377, 359, 380, 180, 70, 270, 88, 380, 353, 290, 219, 61, 147, 23, 85, 543, 384, 87, 72, 22, 123, 56, 177, 434, 209, 92, 160, 343, 342, 83, 376, 79, 518, 22, 88, 105, 118, 61, 522, 176, 444, 145, 119, 379, 90, 87, 263, 141, 88, 433, 156, 67, 116, 77, 303, 203, 177, 682, 284, 96, 333, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2870590779398623, "mean_inference_ms": 10.289218946804104, "mean_action_processing_ms": 0.31315566001805517, "mean_env_wait_ms": 53.690263165350814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 151164, "timesteps_this_iter": 7956, "agent_timesteps_total": 151164, "timers": {"sample_time_ms": 42231.135, "sample_throughput": 188.392, "load_time_ms": 110.063, "load_throughput": 72285.65, "learn_time_ms": 24717.766, "learn_throughput": 321.874, "update_time_ms": 20.399}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 54592.6042842906, "policy_loss": -0.10184567327490977, "vf_loss": 54592.66387867261, "vf_explained_var": 0.051912372503229366, "kl": 0.012446477507210266, "entropy": 1.1474537306415138, "entropy_coeff": 0.0}}}, "num_steps_sampled": 151164, "num_agent_steps_sampled": 151164, "num_steps_trained": 151164, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 151164}, "done": false, "episodes_total": 1265, "training_iteration": 19, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-23-05", "timestamp": 1648646585, "time_this_iter_s": 41.62968873977661, "time_total_s": 809.0360507965088, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 809.0360507965088, "timesteps_since_restore": 151164, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.969491525423729, "ram_util_percent": 6.761016949152543}}
{"episode_reward_max": -836.3562214112251, "episode_reward_min": -1380.7449292259898, "episode_reward_mean": -1050.978130632183, "episode_len_mean": 211.4, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1056.3663782987314, -1106.3297995778223, -836.3562214112251, -1161.5292470354732, -1034.332265835668, -1073.5452384421667, -986.2028685708592, -1091.675368235312, -991.6754027318082, -1009.3083496193502, -1088.8979554378227, -975.0762620058407, -1155.6765304964713, -945.902942051341, -1044.601917242367, -1057.099269890147, -1015.314418116559, -1039.348993562121, -1111.1280617052064, -1060.4931846288875, -1015.0922009027554, -1040.1624298599177, -1026.2218752108308, -1114.8479726902779, -990.3733342134689, -1063.5396286572611, -1117.832469189775, -1216.0892392047758, -993.955923899809, -1022.6095929614924, -937.7996480403131, -1042.8218786771713, -1078.9691681037623, -980.4164156554749, -1132.5240890274, -1220.4155870202171, -981.0053526620516, -1022.7841110931664, -934.0967155971183, -1120.1025619206887, -939.7663791134122, -1131.9360682834758, -1075.3543119793258, -1080.3682643584607, -1098.7156565959663, -963.9114995754496, -1025.3854017632884, -972.7482922200114, -1009.564825611642, -1109.759491099725, -976.732241682152, -1118.3556714915028, -1374.7714128312375, -1010.1885647244967, -1049.945082239887, -1035.5561700859573, -1174.297946279549, -929.5764285660392, -985.5055196845843, -1070.1424878976136, -985.3909141209018, -957.5949529545297, -1101.6704719493807, -1236.5315351580844, -1174.7073640325762, -992.0955082876587, -991.0043185093705, -1068.9228139976592, -1034.5391230842408, -1251.5552843196479, -1024.4194565779758, -976.5533110122174, -1042.6018436144557, -969.2152311157197, -1055.0290443746019, -1380.7449292259898, -988.8936918868889, -1032.926863270434, -949.4528120968574, -963.6004002592441, -1000.1363566030248, -1009.521430281197, -1014.7202238589581, -906.4167280684258, -980.4766491978562, -1105.7551400487273, -1055.0429461135861, -1291.7351773940188, -1086.3840688747418, -1011.7358850019749, -1119.5014395556598, -1032.7695168383552, -988.1069436872526, -1018.2509350545464, -941.9208835637285, -1194.7958963006126, -981.1720126332201, -1079.6513564972968, -996.6725921764385, -1080.4944260535594], "episode_lengths": [270, 88, 380, 353, 290, 219, 61, 147, 23, 85, 543, 384, 87, 72, 22, 123, 56, 177, 434, 209, 92, 160, 343, 342, 83, 376, 79, 518, 22, 88, 105, 118, 61, 522, 176, 444, 145, 119, 379, 90, 87, 263, 141, 88, 433, 156, 67, 116, 77, 303, 203, 177, 682, 284, 96, 333, 331, 260, 34, 77, 31, 78, 87, 954, 157, 152, 27, 97, 56, 468, 123, 452, 22, 115, 414, 664, 29, 82, 95, 150, 191, 146, 66, 336, 231, 281, 138, 409, 94, 53, 301, 346, 233, 56, 82, 573, 136, 317, 103, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2411242409435697, "mean_inference_ms": 10.281671120261484, "mean_action_processing_ms": 0.31629523193422526, "mean_env_wait_ms": 53.6511247153298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 159120, "timesteps_this_iter": 7956, "agent_timesteps_total": 159120, "timers": {"sample_time_ms": 42245.566, "sample_throughput": 188.327, "load_time_ms": 110.441, "load_throughput": 72038.313, "learn_time_ms": 24717.027, "learn_throughput": 321.883, "update_time_ms": 20.451}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 67816.88488172306, "policy_loss": -0.11718505846376541, "vf_loss": 67816.9558209163, "vf_explained_var": 0.07156960954589228, "kl": 0.013551039918912561, "entropy": 1.194953743664808, "entropy_coeff": 0.0}}}, "num_steps_sampled": 159120, "num_agent_steps_sampled": 159120, "num_steps_trained": 159120, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 159120}, "done": false, "episodes_total": 1308, "training_iteration": 20, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-23-48", "timestamp": 1648646628, "time_this_iter_s": 42.47229528427124, "time_total_s": 851.50834608078, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 851.50834608078, "timesteps_since_restore": 159120, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.747540983606559, "ram_util_percent": 6.7622950819672125}}
{"episode_reward_max": -906.4167280684258, "episode_reward_min": -1380.7449292259898, "episode_reward_mean": -1055.2416825877212, "episode_len_mean": 236.18, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1114.8479726902779, -990.3733342134689, -1063.5396286572611, -1117.832469189775, -1216.0892392047758, -993.955923899809, -1022.6095929614924, -937.7996480403131, -1042.8218786771713, -1078.9691681037623, -980.4164156554749, -1132.5240890274, -1220.4155870202171, -981.0053526620516, -1022.7841110931664, -934.0967155971183, -1120.1025619206887, -939.7663791134122, -1131.9360682834758, -1075.3543119793258, -1080.3682643584607, -1098.7156565959663, -963.9114995754496, -1025.3854017632884, -972.7482922200114, -1009.564825611642, -1109.759491099725, -976.732241682152, -1118.3556714915028, -1374.7714128312375, -1010.1885647244967, -1049.945082239887, -1035.5561700859573, -1174.297946279549, -929.5764285660392, -985.5055196845843, -1070.1424878976136, -985.3909141209018, -957.5949529545297, -1101.6704719493807, -1236.5315351580844, -1174.7073640325762, -992.0955082876587, -991.0043185093705, -1068.9228139976592, -1034.5391230842408, -1251.5552843196479, -1024.4194565779758, -976.5533110122174, -1042.6018436144557, -969.2152311157197, -1055.0290443746019, -1380.7449292259898, -988.8936918868889, -1032.926863270434, -949.4528120968574, -963.6004002592441, -1000.1363566030248, -1009.521430281197, -1014.7202238589581, -906.4167280684258, -980.4766491978562, -1105.7551400487273, -1055.0429461135861, -1291.7351773940188, -1086.3840688747418, -1011.7358850019749, -1119.5014395556598, -1032.7695168383552, -988.1069436872526, -1018.2509350545464, -941.9208835637285, -1194.7958963006126, -981.1720126332201, -1079.6513564972968, -996.6725921764385, -1080.4944260535594, -1024.2699938894878, -1206.0470255886128, -967.0652662245329, -1182.6983178083995, -950.593009503688, -1018.822948313038, -1070.8413776276554, -1129.1971801640868, -1272.6289983231309, -990.8774616279014, -1003.4445066155932, -961.5914317454544, -1067.5038951894612, -1113.1143872483503, -1311.0537957029396, -910.8321689941263, -977.0583916971567, -1146.0291486069282, -1029.7519215454709, -966.4672285364486, -1034.4292184302774, -957.3413733583177, -1057.0333296814529], "episode_lengths": [342, 83, 376, 79, 518, 22, 88, 105, 118, 61, 522, 176, 444, 145, 119, 379, 90, 87, 263, 141, 88, 433, 156, 67, 116, 77, 303, 203, 177, 682, 284, 96, 333, 331, 260, 34, 77, 31, 78, 87, 954, 157, 152, 27, 97, 56, 468, 123, 452, 22, 115, 414, 664, 29, 82, 95, 150, 191, 146, 66, 336, 231, 281, 138, 409, 94, 53, 301, 346, 233, 56, 82, 573, 136, 317, 103, 302, 229, 227, 109, 144, 93, 200, 242, 618, 525, 24, 188, 349, 169, 1249, 768, 351, 295, 133, 114, 219, 279, 293, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1996265596852385, "mean_inference_ms": 10.272085330344948, "mean_action_processing_ms": 0.3129968828540382, "mean_env_wait_ms": 53.66222924030815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 167076, "timesteps_this_iter": 7956, "agent_timesteps_total": 167076, "timers": {"sample_time_ms": 42170.022, "sample_throughput": 188.665, "load_time_ms": 110.268, "load_throughput": 72151.753, "learn_time_ms": 24715.923, "learn_throughput": 321.898, "update_time_ms": 20.115}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 40307.35993038711, "policy_loss": -0.10095516180479398, "vf_loss": 40307.42081115067, "vf_explained_var": 0.03383607156174157, "kl": 0.011729167852454083, "entropy": 0.9858808810512225, "entropy_coeff": 0.0}}}, "num_steps_sampled": 167076, "num_agent_steps_sampled": 167076, "num_steps_trained": 167076, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 167076}, "done": false, "episodes_total": 1331, "training_iteration": 21, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-24-29", "timestamp": 1648646669, "time_this_iter_s": 41.70491623878479, "time_total_s": 893.2132623195648, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 893.2132623195648, "timesteps_since_restore": 167076, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.833898305084746, "ram_util_percent": 6.761016949152543}}
{"episode_reward_max": -906.4167280684258, "episode_reward_min": -1474.5613588155663, "episode_reward_mean": -1063.6033766207554, "episode_len_mean": 249.1, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1035.5561700859573, -1174.297946279549, -929.5764285660392, -985.5055196845843, -1070.1424878976136, -985.3909141209018, -957.5949529545297, -1101.6704719493807, -1236.5315351580844, -1174.7073640325762, -992.0955082876587, -991.0043185093705, -1068.9228139976592, -1034.5391230842408, -1251.5552843196479, -1024.4194565779758, -976.5533110122174, -1042.6018436144557, -969.2152311157197, -1055.0290443746019, -1380.7449292259898, -988.8936918868889, -1032.926863270434, -949.4528120968574, -963.6004002592441, -1000.1363566030248, -1009.521430281197, -1014.7202238589581, -906.4167280684258, -980.4766491978562, -1105.7551400487273, -1055.0429461135861, -1291.7351773940188, -1086.3840688747418, -1011.7358850019749, -1119.5014395556598, -1032.7695168383552, -988.1069436872526, -1018.2509350545464, -941.9208835637285, -1194.7958963006126, -981.1720126332201, -1079.6513564972968, -996.6725921764385, -1080.4944260535594, -1024.2699938894878, -1206.0470255886128, -967.0652662245329, -1182.6983178083995, -950.593009503688, -1018.822948313038, -1070.8413776276554, -1129.1971801640868, -1272.6289983231309, -990.8774616279014, -1003.4445066155932, -961.5914317454544, -1067.5038951894612, -1113.1143872483503, -1311.0537957029396, -910.8321689941263, -977.0583916971567, -1146.0291486069282, -1029.7519215454709, -966.4672285364486, -1034.4292184302774, -957.3413733583177, -1057.0333296814529, -1001.9426278337689, -1111.076601527096, -1032.3698930241928, -1263.7456536460534, -989.9123114858253, -930.7710852285455, -1051.2632428668517, -1067.7808579216126, -1012.4759603081621, -1189.8404882964498, -992.2024058176357, -1048.4412087070546, -1134.0331439920265, -1048.5418835061962, -1166.6530666859967, -936.9682953114766, -1263.2013562626726, -1204.2770447538962, -1040.8808291345247, -941.1423517341369, -1071.5124962336156, -1474.5613588155663, -1326.3886042416748, -986.1049052608724, -986.7634675943145, -1044.5914510153737, -1028.6262523752182, -1107.6418730176408, -947.2659065130258, -1092.7752327473693, -1131.1955109662972, -1118.9088886625286], "episode_lengths": [333, 331, 260, 34, 77, 31, 78, 87, 954, 157, 152, 27, 97, 56, 468, 123, 452, 22, 115, 414, 664, 29, 82, 95, 150, 191, 146, 66, 336, 231, 281, 138, 409, 94, 53, 301, 346, 233, 56, 82, 573, 136, 317, 103, 302, 229, 227, 109, 144, 93, 200, 242, 618, 525, 24, 188, 349, 169, 1249, 768, 351, 295, 133, 114, 219, 279, 293, 278, 120, 114, 78, 524, 28, 118, 255, 655, 81, 478, 24, 90, 205, 99, 194, 423, 609, 178, 296, 86, 263, 898, 504, 323, 95, 198, 53, 94, 101, 521, 123, 304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1175340351131435, "mean_inference_ms": 10.278770070462949, "mean_action_processing_ms": 0.31269942255818134, "mean_env_wait_ms": 53.66594792697193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 175032, "timesteps_this_iter": 7956, "agent_timesteps_total": 175032, "timers": {"sample_time_ms": 42093.901, "sample_throughput": 189.006, "load_time_ms": 110.352, "load_throughput": 72096.881, "learn_time_ms": 24722.091, "learn_throughput": 321.817, "update_time_ms": 11.375}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 49676.52138816259, "policy_loss": -0.11487081378713371, "vf_loss": 49676.591451993554, "vf_explained_var": 0.1792142923480721, "kl": 0.013106859003172438, "entropy": 1.1672836800576538, "entropy_coeff": 0.0}}}, "num_steps_sampled": 175032, "num_agent_steps_sampled": 175032, "num_steps_trained": 175032, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 175032}, "done": false, "episodes_total": 1363, "training_iteration": 22, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-25-11", "timestamp": 1648646711, "time_this_iter_s": 41.952648639678955, "time_total_s": 935.1659109592438, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 935.1659109592438, "timesteps_since_restore": 175032, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.81, "ram_util_percent": 6.761666666666667}}
{"episode_reward_max": -910.8321689941263, "episode_reward_min": -1474.5613588155663, "episode_reward_mean": -1072.4940040555855, "episode_len_mean": 259.01, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1055.0429461135861, -1291.7351773940188, -1086.3840688747418, -1011.7358850019749, -1119.5014395556598, -1032.7695168383552, -988.1069436872526, -1018.2509350545464, -941.9208835637285, -1194.7958963006126, -981.1720126332201, -1079.6513564972968, -996.6725921764385, -1080.4944260535594, -1024.2699938894878, -1206.0470255886128, -967.0652662245329, -1182.6983178083995, -950.593009503688, -1018.822948313038, -1070.8413776276554, -1129.1971801640868, -1272.6289983231309, -990.8774616279014, -1003.4445066155932, -961.5914317454544, -1067.5038951894612, -1113.1143872483503, -1311.0537957029396, -910.8321689941263, -977.0583916971567, -1146.0291486069282, -1029.7519215454709, -966.4672285364486, -1034.4292184302774, -957.3413733583177, -1057.0333296814529, -1001.9426278337689, -1111.076601527096, -1032.3698930241928, -1263.7456536460534, -989.9123114858253, -930.7710852285455, -1051.2632428668517, -1067.7808579216126, -1012.4759603081621, -1189.8404882964498, -992.2024058176357, -1048.4412087070546, -1134.0331439920265, -1048.5418835061962, -1166.6530666859967, -936.9682953114766, -1263.2013562626726, -1204.2770447538962, -1040.8808291345247, -941.1423517341369, -1071.5124962336156, -1474.5613588155663, -1326.3886042416748, -986.1049052608724, -986.7634675943145, -1044.5914510153737, -1028.6262523752182, -1107.6418730176408, -947.2659065130258, -1092.7752327473693, -1131.1955109662972, -1118.9088886625286, -1327.8376058918593, -984.5057833378411, -1186.700708685511, -1081.1372480992088, -985.9993798614936, -1122.2186671370769, -1109.2892173347773, -1013.1485531498327, -1208.3969078602304, -1055.6630727049298, -1228.9067105541362, -941.8449934553178, -922.3303237157946, -1065.1234191066303, -990.4382600727533, -984.5515477903987, -989.192697361156, -1138.9327310054514, -1036.7225678811114, -1032.1716755125292, -1181.2049044386908, -1004.5515886387464, -1176.372390431055, -966.4829190909156, -1213.9665914528173, -973.6782354610287, -1078.6161249235668, -995.1723198402958, -1064.065969567271, -920.4764209253234, -1298.9181586156133], "episode_lengths": [138, 409, 94, 53, 301, 346, 233, 56, 82, 573, 136, 317, 103, 302, 229, 227, 109, 144, 93, 200, 242, 618, 525, 24, 188, 349, 169, 1249, 768, 351, 295, 133, 114, 219, 279, 293, 278, 120, 114, 78, 524, 28, 118, 255, 655, 81, 478, 24, 90, 205, 99, 194, 423, 609, 178, 296, 86, 263, 898, 504, 323, 95, 198, 53, 94, 101, 521, 123, 304, 638, 84, 564, 146, 292, 144, 353, 87, 298, 255, 372, 236, 185, 48, 101, 145, 26, 362, 96, 185, 304, 302, 302, 50, 535, 164, 302, 20, 212, 194, 528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0227980699368446, "mean_inference_ms": 10.27554559527202, "mean_action_processing_ms": 0.31098615126108586, "mean_env_wait_ms": 53.64024978118482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 182988, "timesteps_this_iter": 7956, "agent_timesteps_total": 182988, "timers": {"sample_time_ms": 42079.375, "sample_throughput": 189.071, "load_time_ms": 110.232, "load_throughput": 72174.755, "learn_time_ms": 24717.247, "learn_throughput": 321.881, "update_time_ms": 11.373}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 44866.44432025212, "policy_loss": -0.10675481885311104, "vf_loss": 44866.509219327534, "vf_explained_var": -0.007097957467520109, "kl": 0.01228345370217864, "entropy": 1.181941435349885, "entropy_coeff": 0.0}}}, "num_steps_sampled": 182988, "num_agent_steps_sampled": 182988, "num_steps_trained": 182988, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 182988}, "done": false, "episodes_total": 1394, "training_iteration": 23, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-25-53", "timestamp": 1648646753, "time_this_iter_s": 41.91853380203247, "time_total_s": 977.0844447612762, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 977.0844447612762, "timesteps_since_restore": 182988, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 8.9271186440678, "ram_util_percent": 6.7593220338983055}}
{"episode_reward_max": -910.8321689941263, "episode_reward_min": -1474.5613588155663, "episode_reward_mean": -1078.7843609992392, "episode_len_mean": 252.27, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1311.0537957029396, -910.8321689941263, -977.0583916971567, -1146.0291486069282, -1029.7519215454709, -966.4672285364486, -1034.4292184302774, -957.3413733583177, -1057.0333296814529, -1001.9426278337689, -1111.076601527096, -1032.3698930241928, -1263.7456536460534, -989.9123114858253, -930.7710852285455, -1051.2632428668517, -1067.7808579216126, -1012.4759603081621, -1189.8404882964498, -992.2024058176357, -1048.4412087070546, -1134.0331439920265, -1048.5418835061962, -1166.6530666859967, -936.9682953114766, -1263.2013562626726, -1204.2770447538962, -1040.8808291345247, -941.1423517341369, -1071.5124962336156, -1474.5613588155663, -1326.3886042416748, -986.1049052608724, -986.7634675943145, -1044.5914510153737, -1028.6262523752182, -1107.6418730176408, -947.2659065130258, -1092.7752327473693, -1131.1955109662972, -1118.9088886625286, -1327.8376058918593, -984.5057833378411, -1186.700708685511, -1081.1372480992088, -985.9993798614936, -1122.2186671370769, -1109.2892173347773, -1013.1485531498327, -1208.3969078602304, -1055.6630727049298, -1228.9067105541362, -941.8449934553178, -922.3303237157946, -1065.1234191066303, -990.4382600727533, -984.5515477903987, -989.192697361156, -1138.9327310054514, -1036.7225678811114, -1032.1716755125292, -1181.2049044386908, -1004.5515886387464, -1176.372390431055, -966.4829190909156, -1213.9665914528173, -973.6782354610287, -1078.6161249235668, -995.1723198402958, -1064.065969567271, -920.4764209253234, -1298.9181586156133, -1193.4342237116016, -1273.1227694085715, -1071.225585835965, -1096.5513532252246, -1134.5155301576049, -1143.9183760662056, -981.9558771005487, -1034.2085572485428, -965.8642180667513, -1422.308935446838, -943.4963184036287, -1205.1627093487748, -1029.4338274075392, -987.961296588939, -1061.4799189208898, -1114.080023016822, -1170.968273137065, -1192.2675715470953, -1104.412013428534, -970.2869922301094, -968.0098689936535, -985.8558440573493, -1055.061766770865, -1017.7920696675473, -1112.070596098261, -995.6291680611733, -1102.2453454235026, -1132.6465446101693], "episode_lengths": [768, 351, 295, 133, 114, 219, 279, 293, 278, 120, 114, 78, 524, 28, 118, 255, 655, 81, 478, 24, 90, 205, 99, 194, 423, 609, 178, 296, 86, 263, 898, 504, 323, 95, 198, 53, 94, 101, 521, 123, 304, 638, 84, 564, 146, 292, 144, 353, 87, 298, 255, 372, 236, 185, 48, 101, 145, 26, 362, 96, 185, 304, 302, 302, 50, 535, 164, 302, 20, 212, 194, 528, 158, 459, 104, 390, 356, 98, 38, 123, 154, 927, 90, 361, 109, 28, 86, 372, 433, 486, 374, 83, 539, 37, 230, 80, 188, 95, 79, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9709335426836496, "mean_inference_ms": 10.276934092180392, "mean_action_processing_ms": 0.3094100153837277, "mean_env_wait_ms": 53.61444042893056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 190944, "timesteps_this_iter": 7956, "agent_timesteps_total": 190944, "timers": {"sample_time_ms": 42028.466, "sample_throughput": 189.3, "load_time_ms": 110.266, "load_throughput": 72153.079, "learn_time_ms": 24724.451, "learn_throughput": 321.787, "update_time_ms": 11.145}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 38565.99949330976, "policy_loss": -0.10628244914915613, "vf_loss": 38566.06627013504, "vf_explained_var": -0.09611007648129617, "kl": 0.011588858009838422, "entropy": 1.1528280452214261, "entropy_coeff": 0.0}}}, "num_steps_sampled": 190944, "num_agent_steps_sampled": 190944, "num_steps_trained": 190944, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 190944}, "done": false, "episodes_total": 1422, "training_iteration": 24, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-26-35", "timestamp": 1648646795, "time_this_iter_s": 41.97619295120239, "time_total_s": 1019.0606377124786, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1019.0606377124786, "timesteps_since_restore": 190944, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 8.85, "ram_util_percent": 6.760000000000001}}
{"episode_reward_max": -758.086308137973, "episode_reward_min": -1474.5613588155663, "episode_reward_mean": -1072.1531249823304, "episode_len_mean": 260.5, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1166.6530666859967, -936.9682953114766, -1263.2013562626726, -1204.2770447538962, -1040.8808291345247, -941.1423517341369, -1071.5124962336156, -1474.5613588155663, -1326.3886042416748, -986.1049052608724, -986.7634675943145, -1044.5914510153737, -1028.6262523752182, -1107.6418730176408, -947.2659065130258, -1092.7752327473693, -1131.1955109662972, -1118.9088886625286, -1327.8376058918593, -984.5057833378411, -1186.700708685511, -1081.1372480992088, -985.9993798614936, -1122.2186671370769, -1109.2892173347773, -1013.1485531498327, -1208.3969078602304, -1055.6630727049298, -1228.9067105541362, -941.8449934553178, -922.3303237157946, -1065.1234191066303, -990.4382600727533, -984.5515477903987, -989.192697361156, -1138.9327310054514, -1036.7225678811114, -1032.1716755125292, -1181.2049044386908, -1004.5515886387464, -1176.372390431055, -966.4829190909156, -1213.9665914528173, -973.6782354610287, -1078.6161249235668, -995.1723198402958, -1064.065969567271, -920.4764209253234, -1298.9181586156133, -1193.4342237116016, -1273.1227694085715, -1071.225585835965, -1096.5513532252246, -1134.5155301576049, -1143.9183760662056, -981.9558771005487, -1034.2085572485428, -965.8642180667513, -1422.308935446838, -943.4963184036287, -1205.1627093487748, -1029.4338274075392, -987.961296588939, -1061.4799189208898, -1114.080023016822, -1170.968273137065, -1192.2675715470953, -1104.412013428534, -970.2869922301094, -968.0098689936535, -985.8558440573493, -1055.061766770865, -1017.7920696675473, -1112.070596098261, -995.6291680611733, -1102.2453454235026, -1132.6465446101693, -1029.279125432762, -923.1299703950058, -938.1249729436543, -943.7504219382066, -1006.8835330574332, -1022.8438742308622, -883.640884016048, -1166.8474768910087, -1049.5272429230452, -1067.3304141457115, -1042.222102939081, -1029.1458207973792, -1080.902665468942, -1014.6205284946567, -1364.1116934067725, -961.5832765344524, -957.3657036836322, -758.086308137973, -1010.8948191441011, -990.4522863007919, -1124.312309943116, -1171.9479249783833, -1064.2669832207064], "episode_lengths": [194, 423, 609, 178, 296, 86, 263, 898, 504, 323, 95, 198, 53, 94, 101, 521, 123, 304, 638, 84, 564, 146, 292, 144, 353, 87, 298, 255, 372, 236, 185, 48, 101, 145, 26, 362, 96, 185, 304, 302, 302, 50, 535, 164, 302, 20, 212, 194, 528, 158, 459, 104, 390, 356, 98, 38, 123, 154, 927, 90, 361, 109, 28, 86, 372, 433, 486, 374, 83, 539, 37, 230, 80, 188, 95, 79, 358, 460, 107, 248, 251, 524, 315, 303, 428, 83, 100, 115, 552, 94, 58, 695, 312, 54, 520, 417, 28, 158, 180, 420]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.926379417151322, "mean_inference_ms": 10.267925494971047, "mean_action_processing_ms": 0.3087452988004133, "mean_env_wait_ms": 53.61010726242525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 198900, "timesteps_this_iter": 7956, "agent_timesteps_total": 198900, "timers": {"sample_time_ms": 41913.418, "sample_throughput": 189.82, "load_time_ms": 110.337, "load_throughput": 72106.103, "learn_time_ms": 24725.363, "learn_throughput": 321.775, "update_time_ms": 11.055}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 25660.58472509897, "policy_loss": -0.09931542530720953, "vf_loss": 25660.64545196205, "vf_explained_var": 0.046584419986253144, "kl": 0.011313518784182621, "entropy": 1.024142494781684, "entropy_coeff": 0.0}}}, "num_steps_sampled": 198900, "num_agent_steps_sampled": 198900, "num_steps_trained": 198900, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 198900}, "done": false, "episodes_total": 1445, "training_iteration": 25, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-27-17", "timestamp": 1648646837, "time_this_iter_s": 41.6541588306427, "time_total_s": 1060.7147965431213, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1060.7147965431213, "timesteps_since_restore": 198900, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 8.801666666666668, "ram_util_percent": 6.765}}
{"episode_reward_max": -758.086308137973, "episode_reward_min": -1430.8450240559325, "episode_reward_mean": -1076.9149443528677, "episode_len_mean": 271.2, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1186.700708685511, -1081.1372480992088, -985.9993798614936, -1122.2186671370769, -1109.2892173347773, -1013.1485531498327, -1208.3969078602304, -1055.6630727049298, -1228.9067105541362, -941.8449934553178, -922.3303237157946, -1065.1234191066303, -990.4382600727533, -984.5515477903987, -989.192697361156, -1138.9327310054514, -1036.7225678811114, -1032.1716755125292, -1181.2049044386908, -1004.5515886387464, -1176.372390431055, -966.4829190909156, -1213.9665914528173, -973.6782354610287, -1078.6161249235668, -995.1723198402958, -1064.065969567271, -920.4764209253234, -1298.9181586156133, -1193.4342237116016, -1273.1227694085715, -1071.225585835965, -1096.5513532252246, -1134.5155301576049, -1143.9183760662056, -981.9558771005487, -1034.2085572485428, -965.8642180667513, -1422.308935446838, -943.4963184036287, -1205.1627093487748, -1029.4338274075392, -987.961296588939, -1061.4799189208898, -1114.080023016822, -1170.968273137065, -1192.2675715470953, -1104.412013428534, -970.2869922301094, -968.0098689936535, -985.8558440573493, -1055.061766770865, -1017.7920696675473, -1112.070596098261, -995.6291680611733, -1102.2453454235026, -1132.6465446101693, -1029.279125432762, -923.1299703950058, -938.1249729436543, -943.7504219382066, -1006.8835330574332, -1022.8438742308622, -883.640884016048, -1166.8474768910087, -1049.5272429230452, -1067.3304141457115, -1042.222102939081, -1029.1458207973792, -1080.902665468942, -1014.6205284946567, -1364.1116934067725, -961.5832765344524, -957.3657036836322, -758.086308137973, -1010.8948191441011, -990.4522863007919, -1124.312309943116, -1171.9479249783833, -1064.2669832207064, -1214.5768497421218, -1055.942039797219, -1153.3296156651277, -1063.0582899192048, -987.0451055110044, -1230.7331832305695, -983.4782036389207, -1200.921400121585, -979.8592229234467, -1337.235020439779, -1430.8450240559325, -1168.3581404425227, -1261.7190766365127, -1162.8828543160148, -1160.9273873344246, -1105.8462688624338, -1020.3107199786652, -1025.9419969110115, -932.9112117485749, -1182.0626063345353], "episode_lengths": [564, 146, 292, 144, 353, 87, 298, 255, 372, 236, 185, 48, 101, 145, 26, 362, 96, 185, 304, 302, 302, 50, 535, 164, 302, 20, 212, 194, 528, 158, 459, 104, 390, 356, 98, 38, 123, 154, 927, 90, 361, 109, 28, 86, 372, 433, 486, 374, 83, 539, 37, 230, 80, 188, 95, 79, 358, 460, 107, 248, 251, 524, 315, 303, 428, 83, 100, 115, 552, 94, 58, 695, 312, 54, 520, 417, 28, 158, 180, 420, 434, 44, 239, 160, 30, 719, 98, 164, 40, 1396, 570, 330, 287, 571, 323, 328, 288, 196, 238, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9108681776020564, "mean_inference_ms": 10.259834379644385, "mean_action_processing_ms": 0.30870992987545653, "mean_env_wait_ms": 53.57790860184047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 206856, "timesteps_this_iter": 7956, "agent_timesteps_total": 206856, "timers": {"sample_time_ms": 41905.996, "sample_throughput": 189.854, "load_time_ms": 110.248, "load_throughput": 72164.36, "learn_time_ms": 24727.726, "learn_throughput": 321.744, "update_time_ms": 10.911}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 31873.93685328986, "policy_loss": -0.10179796202774209, "vf_loss": 31873.997922146704, "vf_explained_var": -0.1845004194205807, "kl": 0.011947914667840098, "entropy": 1.0760655294342707, "entropy_coeff": 0.0}}}, "num_steps_sampled": 206856, "num_agent_steps_sampled": 206856, "num_steps_trained": 206856, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 206856}, "done": false, "episodes_total": 1465, "training_iteration": 26, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-27-59", "timestamp": 1648646879, "time_this_iter_s": 41.801395654678345, "time_total_s": 1102.5161921977997, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1102.5161921977997, "timesteps_since_restore": 206856, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.754237288135593, "ram_util_percent": 6.798305084745762}}
{"episode_reward_max": -758.086308137973, "episode_reward_min": -1579.7578678198633, "episode_reward_mean": -1079.3970252428546, "episode_len_mean": 312.31, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1213.9665914528173, -973.6782354610287, -1078.6161249235668, -995.1723198402958, -1064.065969567271, -920.4764209253234, -1298.9181586156133, -1193.4342237116016, -1273.1227694085715, -1071.225585835965, -1096.5513532252246, -1134.5155301576049, -1143.9183760662056, -981.9558771005487, -1034.2085572485428, -965.8642180667513, -1422.308935446838, -943.4963184036287, -1205.1627093487748, -1029.4338274075392, -987.961296588939, -1061.4799189208898, -1114.080023016822, -1170.968273137065, -1192.2675715470953, -1104.412013428534, -970.2869922301094, -968.0098689936535, -985.8558440573493, -1055.061766770865, -1017.7920696675473, -1112.070596098261, -995.6291680611733, -1102.2453454235026, -1132.6465446101693, -1029.279125432762, -923.1299703950058, -938.1249729436543, -943.7504219382066, -1006.8835330574332, -1022.8438742308622, -883.640884016048, -1166.8474768910087, -1049.5272429230452, -1067.3304141457115, -1042.222102939081, -1029.1458207973792, -1080.902665468942, -1014.6205284946567, -1364.1116934067725, -961.5832765344524, -957.3657036836322, -758.086308137973, -1010.8948191441011, -990.4522863007919, -1124.312309943116, -1171.9479249783833, -1064.2669832207064, -1214.5768497421218, -1055.942039797219, -1153.3296156651277, -1063.0582899192048, -987.0451055110044, -1230.7331832305695, -983.4782036389207, -1200.921400121585, -979.8592229234467, -1337.235020439779, -1430.8450240559325, -1168.3581404425227, -1261.7190766365127, -1162.8828543160148, -1160.9273873344246, -1105.8462688624338, -1020.3107199786652, -1025.9419969110115, -932.9112117485749, -1182.0626063345353, -1086.960521914487, -966.8165491853031, -969.3792375781503, -1016.4453401427087, -1013.3195778655886, -926.8704795051236, -962.6450520943962, -1304.5652841421438, -1116.0963513132028, -1018.093230445802, -1579.7578678198633, -1286.6343647856563, -1072.7934735825722, -774.8450391660804, -874.5375385566268, -1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766], "episode_lengths": [535, 164, 302, 20, 212, 194, 528, 158, 459, 104, 390, 356, 98, 38, 123, 154, 927, 90, 361, 109, 28, 86, 372, 433, 486, 374, 83, 539, 37, 230, 80, 188, 95, 79, 358, 460, 107, 248, 251, 524, 315, 303, 428, 83, 100, 115, 552, 94, 58, 695, 312, 54, 520, 417, 28, 158, 180, 420, 434, 44, 239, 160, 30, 719, 98, 164, 40, 1396, 570, 330, 287, 571, 323, 328, 288, 196, 238, 600, 766, 48, 54, 516, 112, 604, 57, 439, 237, 272, 959, 255, 236, 318, 185, 90, 574, 261, 906, 1414, 144, 517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.863661829880605, "mean_inference_ms": 10.263671350623733, "mean_action_processing_ms": 0.31048742294336223, "mean_env_wait_ms": 53.61319238175725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 214812, "timesteps_this_iter": 7956, "agent_timesteps_total": 214812, "timers": {"sample_time_ms": 41896.074, "sample_throughput": 189.898, "load_time_ms": 110.233, "load_throughput": 72174.537, "learn_time_ms": 24731.708, "learn_throughput": 321.692, "update_time_ms": 10.768}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 37896.58104661511, "policy_loss": -0.10469903502092566, "vf_loss": 37896.64579087124, "vf_explained_var": -0.10239165716914721, "kl": 0.011685325820195373, "entropy": 1.1317756020253704, "entropy_coeff": 0.0}}}, "num_steps_sampled": 214812, "num_agent_steps_sampled": 214812, "num_steps_trained": 214812, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 214812}, "done": false, "episodes_total": 1487, "training_iteration": 27, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-28-41", "timestamp": 1648646921, "time_this_iter_s": 41.739827156066895, "time_total_s": 1144.2560193538666, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1144.2560193538666, "timesteps_since_restore": 214812, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.888333333333332, "ram_util_percent": 6.766666666666667}}
{"episode_reward_max": -758.086308137973, "episode_reward_min": -1579.7578678198633, "episode_reward_mean": -1074.5150760477363, "episode_len_mean": 328.32, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1192.2675715470953, -1104.412013428534, -970.2869922301094, -968.0098689936535, -985.8558440573493, -1055.061766770865, -1017.7920696675473, -1112.070596098261, -995.6291680611733, -1102.2453454235026, -1132.6465446101693, -1029.279125432762, -923.1299703950058, -938.1249729436543, -943.7504219382066, -1006.8835330574332, -1022.8438742308622, -883.640884016048, -1166.8474768910087, -1049.5272429230452, -1067.3304141457115, -1042.222102939081, -1029.1458207973792, -1080.902665468942, -1014.6205284946567, -1364.1116934067725, -961.5832765344524, -957.3657036836322, -758.086308137973, -1010.8948191441011, -990.4522863007919, -1124.312309943116, -1171.9479249783833, -1064.2669832207064, -1214.5768497421218, -1055.942039797219, -1153.3296156651277, -1063.0582899192048, -987.0451055110044, -1230.7331832305695, -983.4782036389207, -1200.921400121585, -979.8592229234467, -1337.235020439779, -1430.8450240559325, -1168.3581404425227, -1261.7190766365127, -1162.8828543160148, -1160.9273873344246, -1105.8462688624338, -1020.3107199786652, -1025.9419969110115, -932.9112117485749, -1182.0626063345353, -1086.960521914487, -966.8165491853031, -969.3792375781503, -1016.4453401427087, -1013.3195778655886, -926.8704795051236, -962.6450520943962, -1304.5652841421438, -1116.0963513132028, -1018.093230445802, -1579.7578678198633, -1286.6343647856563, -1072.7934735825722, -774.8450391660804, -874.5375385566268, -1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766, -1140.5977320508919, -1019.0376335598816, -1080.3710032278545, -1159.6578789984733, -1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915], "episode_lengths": [486, 374, 83, 539, 37, 230, 80, 188, 95, 79, 358, 460, 107, 248, 251, 524, 315, 303, 428, 83, 100, 115, 552, 94, 58, 695, 312, 54, 520, 417, 28, 158, 180, 420, 434, 44, 239, 160, 30, 719, 98, 164, 40, 1396, 570, 330, 287, 571, 323, 328, 288, 196, 238, 600, 766, 48, 54, 516, 112, 604, 57, 439, 237, 272, 959, 255, 236, 318, 185, 90, 574, 261, 906, 1414, 144, 517, 187, 90, 99, 139, 357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.808627345160949, "mean_inference_ms": 10.252159564906092, "mean_action_processing_ms": 0.3096122359978901, "mean_env_wait_ms": 53.626333615669544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 222768, "timesteps_this_iter": 7956, "agent_timesteps_total": 222768, "timers": {"sample_time_ms": 41927.143, "sample_throughput": 189.758, "load_time_ms": 110.236, "load_throughput": 72172.617, "learn_time_ms": 24765.173, "learn_throughput": 321.258, "update_time_ms": 11.167}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 33896.605772219424, "policy_loss": -0.09832902983712252, "vf_loss": 33896.66570473948, "vf_explained_var": -0.0928691824277242, "kl": 0.01122107974352458, "entropy": 1.0890970858034268, "entropy_coeff": 0.0}}}, "num_steps_sampled": 222768, "num_agent_steps_sampled": 222768, "num_steps_trained": 222768, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 222768}, "done": false, "episodes_total": 1511, "training_iteration": 28, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-29-23", "timestamp": 1648646963, "time_this_iter_s": 42.113948583602905, "time_total_s": 1186.3699679374695, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1186.3699679374695, "timesteps_since_restore": 222768, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.916666666666664, "ram_util_percent": 6.763333333333334}}
{"episode_reward_max": -758.086308137973, "episode_reward_min": -1579.7578678198633, "episode_reward_mean": -1083.2548789672016, "episode_len_mean": 354.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-943.7504219382066, -1006.8835330574332, -1022.8438742308622, -883.640884016048, -1166.8474768910087, -1049.5272429230452, -1067.3304141457115, -1042.222102939081, -1029.1458207973792, -1080.902665468942, -1014.6205284946567, -1364.1116934067725, -961.5832765344524, -957.3657036836322, -758.086308137973, -1010.8948191441011, -990.4522863007919, -1124.312309943116, -1171.9479249783833, -1064.2669832207064, -1214.5768497421218, -1055.942039797219, -1153.3296156651277, -1063.0582899192048, -987.0451055110044, -1230.7331832305695, -983.4782036389207, -1200.921400121585, -979.8592229234467, -1337.235020439779, -1430.8450240559325, -1168.3581404425227, -1261.7190766365127, -1162.8828543160148, -1160.9273873344246, -1105.8462688624338, -1020.3107199786652, -1025.9419969110115, -932.9112117485749, -1182.0626063345353, -1086.960521914487, -966.8165491853031, -969.3792375781503, -1016.4453401427087, -1013.3195778655886, -926.8704795051236, -962.6450520943962, -1304.5652841421438, -1116.0963513132028, -1018.093230445802, -1579.7578678198633, -1286.6343647856563, -1072.7934735825722, -774.8450391660804, -874.5375385566268, -1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766, -1140.5977320508919, -1019.0376335598816, -1080.3710032278545, -1159.6578789984733, -1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463], "episode_lengths": [251, 524, 315, 303, 428, 83, 100, 115, 552, 94, 58, 695, 312, 54, 520, 417, 28, 158, 180, 420, 434, 44, 239, 160, 30, 719, 98, 164, 40, 1396, 570, 330, 287, 571, 323, 328, 288, 196, 238, 600, 766, 48, 54, 516, 112, 604, 57, 439, 237, 272, 959, 255, 236, 318, 185, 90, 574, 261, 906, 1414, 144, 517, 187, 90, 99, 139, 357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7830079225457744, "mean_inference_ms": 10.241785404266132, "mean_action_processing_ms": 0.3083653972561377, "mean_env_wait_ms": 53.63817509754331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 230724, "timesteps_this_iter": 7956, "agent_timesteps_total": 230724, "timers": {"sample_time_ms": 41939.552, "sample_throughput": 189.702, "load_time_ms": 110.439, "load_throughput": 72039.915, "learn_time_ms": 24787.419, "learn_throughput": 320.969, "update_time_ms": 12.026}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 29484.14503698862, "policy_loss": -0.0967974631696619, "vf_loss": 29484.206368591964, "vf_explained_var": -0.12906684292260037, "kl": 0.010389550710086607, "entropy": 0.9560370480501523, "entropy_coeff": 0.0}}}, "num_steps_sampled": 230724, "num_agent_steps_sampled": 230724, "num_steps_trained": 230724, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 230724}, "done": false, "episodes_total": 1525, "training_iteration": 29, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-30-05", "timestamp": 1648647005, "time_this_iter_s": 41.65166091918945, "time_total_s": 1228.021628856659, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1228.021628856659, "timesteps_since_restore": 230724, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.405084745762712, "ram_util_percent": 6.772881355932203}}
{"episode_reward_max": -774.8450391660804, "episode_reward_min": -1579.7578678198633, "episode_reward_mean": -1086.007367990338, "episode_len_mean": 355.62, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-990.4522863007919, -1124.312309943116, -1171.9479249783833, -1064.2669832207064, -1214.5768497421218, -1055.942039797219, -1153.3296156651277, -1063.0582899192048, -987.0451055110044, -1230.7331832305695, -983.4782036389207, -1200.921400121585, -979.8592229234467, -1337.235020439779, -1430.8450240559325, -1168.3581404425227, -1261.7190766365127, -1162.8828543160148, -1160.9273873344246, -1105.8462688624338, -1020.3107199786652, -1025.9419969110115, -932.9112117485749, -1182.0626063345353, -1086.960521914487, -966.8165491853031, -969.3792375781503, -1016.4453401427087, -1013.3195778655886, -926.8704795051236, -962.6450520943962, -1304.5652841421438, -1116.0963513132028, -1018.093230445802, -1579.7578678198633, -1286.6343647856563, -1072.7934735825722, -774.8450391660804, -874.5375385566268, -1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766, -1140.5977320508919, -1019.0376335598816, -1080.3710032278545, -1159.6578789984733, -1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203], "episode_lengths": [28, 158, 180, 420, 434, 44, 239, 160, 30, 719, 98, 164, 40, 1396, 570, 330, 287, 571, 323, 328, 288, 196, 238, 600, 766, 48, 54, 516, 112, 604, 57, 439, 237, 272, 959, 255, 236, 318, 185, 90, 574, 261, 906, 1414, 144, 517, 187, 90, 99, 139, 357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7406717817323396, "mean_inference_ms": 10.247884684674439, "mean_action_processing_ms": 0.3097368229230508, "mean_env_wait_ms": 53.63245131772598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 238680, "timesteps_this_iter": 7956, "agent_timesteps_total": 238680, "timers": {"sample_time_ms": 41901.702, "sample_throughput": 189.873, "load_time_ms": 110.247, "load_throughput": 72165.468, "learn_time_ms": 24786.691, "learn_throughput": 320.979, "update_time_ms": 13.129}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 24223.982983185142, "policy_loss": -0.10139536428896169, "vf_loss": 24224.046301138274, "vf_explained_var": -0.1360511588793929, "kl": 0.011113135816977293, "entropy": 1.019270598840329, "entropy_coeff": 0.0}}}, "num_steps_sampled": 238680, "num_agent_steps_sampled": 238680, "num_steps_trained": 238680, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 238680}, "done": false, "episodes_total": 1541, "training_iteration": 30, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-30-47", "timestamp": 1648647047, "time_this_iter_s": 41.86343550682068, "time_total_s": 1269.8850643634796, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1269.8850643634796, "timesteps_since_restore": 238680, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 8.84, "ram_util_percent": 6.765}}
{"episode_reward_max": -762.7617298310106, "episode_reward_min": -1579.7578678198633, "episode_reward_mean": -1084.0411664267108, "episode_len_mean": 371.81, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1261.7190766365127, -1162.8828543160148, -1160.9273873344246, -1105.8462688624338, -1020.3107199786652, -1025.9419969110115, -932.9112117485749, -1182.0626063345353, -1086.960521914487, -966.8165491853031, -969.3792375781503, -1016.4453401427087, -1013.3195778655886, -926.8704795051236, -962.6450520943962, -1304.5652841421438, -1116.0963513132028, -1018.093230445802, -1579.7578678198633, -1286.6343647856563, -1072.7934735825722, -774.8450391660804, -874.5375385566268, -1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766, -1140.5977320508919, -1019.0376335598816, -1080.3710032278545, -1159.6578789984733, -1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642], "episode_lengths": [287, 571, 323, 328, 288, 196, 238, 600, 766, 48, 54, 516, 112, 604, 57, 439, 237, 272, 959, 255, 236, 318, 185, 90, 574, 261, 906, 1414, 144, 517, 187, 90, 99, 139, 357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.674227263704736, "mean_inference_ms": 10.249452873957493, "mean_action_processing_ms": 0.30918005074984456, "mean_env_wait_ms": 53.628088822214856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 246636, "timesteps_this_iter": 7956, "agent_timesteps_total": 246636, "timers": {"sample_time_ms": 41903.106, "sample_throughput": 189.867, "load_time_ms": 107.494, "load_throughput": 74013.271, "learn_time_ms": 24780.093, "learn_throughput": 321.064, "update_time_ms": 13.385}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 28603.305049231745, "policy_loss": -0.09748719795456817, "vf_loss": 28603.36564691195, "vf_explained_var": -0.26681869927273, "kl": 0.010791751101617128, "entropy": 0.9726251255600683, "entropy_coeff": 0.0}}}, "num_steps_sampled": 246636, "num_agent_steps_sampled": 246636, "num_steps_trained": 246636, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 246636}, "done": false, "episodes_total": 1557, "training_iteration": 31, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-31-28", "timestamp": 1648647088, "time_this_iter_s": 41.61768317222595, "time_total_s": 1311.5027475357056, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1311.5027475357056, "timesteps_since_restore": 246636, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 8.866101694915255, "ram_util_percent": 6.7593220338983055}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1579.7578678198633, "episode_reward_mean": -1080.9157240263787, "episode_len_mean": 416.13, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.0963513132028, -1018.093230445802, -1579.7578678198633, -1286.6343647856563, -1072.7934735825722, -774.8450391660804, -874.5375385566268, -1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766, -1140.5977320508919, -1019.0376335598816, -1080.3710032278545, -1159.6578789984733, -1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647], "episode_lengths": [237, 272, 959, 255, 236, 318, 185, 90, 574, 261, 906, 1414, 144, 517, 187, 90, 99, 139, 357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6295120772682834, "mean_inference_ms": 10.23856088597511, "mean_action_processing_ms": 0.309073601403167, "mean_env_wait_ms": 53.607065199523056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 254592, "timesteps_this_iter": 7956, "agent_timesteps_total": 254592, "timers": {"sample_time_ms": 41856.976, "sample_throughput": 190.076, "load_time_ms": 107.512, "load_throughput": 74001.355, "learn_time_ms": 24787.955, "learn_throughput": 320.962, "update_time_ms": 13.736}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 29879.945459410967, "policy_loss": -0.10557440525441561, "vf_loss": 29880.010982390373, "vf_explained_var": -0.1760598628110783, "kl": 0.011682217193578344, "entropy": 1.0232955321188897, "entropy_coeff": 0.0}}}, "num_steps_sampled": 254592, "num_agent_steps_sampled": 254592, "num_steps_trained": 254592, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 254592}, "done": false, "episodes_total": 1573, "training_iteration": 32, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-32-10", "timestamp": 1648647130, "time_this_iter_s": 41.6643922328949, "time_total_s": 1353.1671397686005, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1353.1671397686005, "timesteps_since_restore": 254592, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 8.943333333333332, "ram_util_percent": 6.786666666666665}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1544.0725557017622, "episode_reward_mean": -1082.1957047334995, "episode_len_mean": 425.83, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1110.524903302328, -1307.958006053512, -1193.248849013924, -1194.8732672612664, -996.3148867430342, -939.5589330297923, -957.3498193848766, -1140.5977320508919, -1019.0376335598816, -1080.3710032278545, -1159.6578789984733, -1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196], "episode_lengths": [90, 574, 261, 906, 1414, 144, 517, 187, 90, 99, 139, 357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6023314601525183, "mean_inference_ms": 10.240134865284503, "mean_action_processing_ms": 0.30924170206224305, "mean_env_wait_ms": 53.60566684506193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 262548, "timesteps_this_iter": 7956, "agent_timesteps_total": 262548, "timers": {"sample_time_ms": 41850.463, "sample_throughput": 190.105, "load_time_ms": 107.382, "load_throughput": 74090.589, "learn_time_ms": 24794.126, "learn_throughput": 320.882, "update_time_ms": 14.914}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 12839.981836774272, "policy_loss": -0.08655061718046425, "vf_loss": 12840.03485355172, "vf_explained_var": -0.37760517427357293, "kl": 0.009821981964846472, "entropy": 0.8935201189691021, "entropy_coeff": 0.0}}}, "num_steps_sampled": 262548, "num_agent_steps_sampled": 262548, "num_steps_trained": 262548, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 262548}, "done": false, "episodes_total": 1580, "training_iteration": 33, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-32-52", "timestamp": 1648647172, "time_this_iter_s": 41.84388017654419, "time_total_s": 1395.0110199451447, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1395.0110199451447, "timesteps_since_restore": 262548, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.818644067796612, "ram_util_percent": 6.761016949152543}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1544.0725557017622, "episode_reward_mean": -1090.6154396166996, "episode_len_mean": 441.15, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1222.144252092336, -917.4950093475202, -1108.7229344705343, -1024.0497198804514, -1391.2958690355683, -874.7731948842206, -952.4444757358312, -1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152], "episode_lengths": [357, 115, 319, 353, 1098, 170, 284, 314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5634704310117225, "mean_inference_ms": 10.240719092041118, "mean_action_processing_ms": 0.30869684775813866, "mean_env_wait_ms": 53.586363557030566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 270504, "timesteps_this_iter": 7956, "agent_timesteps_total": 270504, "timers": {"sample_time_ms": 41834.117, "sample_throughput": 190.18, "load_time_ms": 107.185, "load_throughput": 74226.998, "learn_time_ms": 24792.09, "learn_throughput": 320.909, "update_time_ms": 14.759}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 20419.793232243035, "policy_loss": -0.09504691051239128, "vf_loss": 20419.854649869856, "vf_explained_var": -0.19985252564312309, "kl": 0.00983911616034855, "entropy": 0.9287367677977009, "entropy_coeff": 0.0}}}, "num_steps_sampled": 270504, "num_agent_steps_sampled": 270504, "num_steps_trained": 270504, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 270504}, "done": false, "episodes_total": 1591, "training_iteration": 34, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-33-34", "timestamp": 1648647214, "time_this_iter_s": 41.70257115364075, "time_total_s": 1436.7135910987854, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1436.7135910987854, "timesteps_since_restore": 270504, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 8.718333333333334, "ram_util_percent": 6.809999999999998}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1769.5011559284283, "episode_reward_mean": -1106.5696438228144, "episode_len_mean": 471.92, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1156.0518996086755, -919.0882791159056, -941.5780197989126, -1082.1772589239451, -1305.7979757262274, -1407.863310603785, -1021.8007597388201, -1015.9879318817615, -1070.403107597078, -952.2969214960985, -1066.2460097767475, -992.4535177558689, -1064.0519990581915, -974.3305167106653, -921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678], "episode_lengths": [314, 105, 120, 651, 435, 798, 310, 459, 418, 770, 152, 23, 76, 129, 110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.528133982028901, "mean_inference_ms": 10.245350047387495, "mean_action_processing_ms": 0.3086498000763168, "mean_env_wait_ms": 53.605429959250834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 278460, "timesteps_this_iter": 7956, "agent_timesteps_total": 278460, "timers": {"sample_time_ms": 41856.294, "sample_throughput": 190.079, "load_time_ms": 107.078, "load_throughput": 74301.255, "learn_time_ms": 24789.476, "learn_throughput": 320.943, "update_time_ms": 14.939}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 15382.350795704831, "policy_loss": -0.08938475094650501, "vf_loss": 15382.408122466713, "vf_explained_var": -0.315541390257497, "kl": 0.009349534175465055, "entropy": 0.8458002341450542, "entropy_coeff": 0.0}}}, "num_steps_sampled": 278460, "num_agent_steps_sampled": 278460, "num_steps_trained": 278460, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 278460}, "done": false, "episodes_total": 1598, "training_iteration": 35, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-34-16", "timestamp": 1648647256, "time_this_iter_s": 41.888388872146606, "time_total_s": 1478.601979970932, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1478.601979970932, "timesteps_since_restore": 278460, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 8.685, "ram_util_percent": 6.766666666666666}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1769.5011559284283, "episode_reward_mean": -1127.778346974183, "episode_len_mean": 541.17, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-921.5735254905683, -992.6907667079925, -1120.0668583318222, -1052.1790471332406, -1006.8038175802986, -1012.6538467720835, -1154.027800635812, -1427.2897161278793, -1037.5657683424117, -1062.2741689058894, -1209.2812990850764, -1335.2326328966456, -1094.8223768858463, -1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518], "episode_lengths": [110, 407, 361, 239, 175, 187, 1199, 863, 471, 449, 516, 587, 329, 581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.484547102264723, "mean_inference_ms": 10.249836740589606, "mean_action_processing_ms": 0.30753213607501745, "mean_env_wait_ms": 53.606085936808704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 286416, "timesteps_this_iter": 7956, "agent_timesteps_total": 286416, "timers": {"sample_time_ms": 41851.612, "sample_throughput": 190.1, "load_time_ms": 106.975, "load_throughput": 74372.396, "learn_time_ms": 24797.422, "learn_throughput": 320.84, "update_time_ms": 15.165}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 30350.066242275443, "policy_loss": -0.10106302923372676, "vf_loss": 30350.12996068975, "vf_explained_var": -0.09155762342996494, "kl": 0.010928139890197081, "entropy": 0.9483788593321718, "entropy_coeff": 0.0}}}, "num_steps_sampled": 286416, "num_agent_steps_sampled": 286416, "num_steps_trained": 286416, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 286416}, "done": false, "episodes_total": 1612, "training_iteration": 36, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-34-58", "timestamp": 1648647298, "time_this_iter_s": 41.85346984863281, "time_total_s": 1520.4554498195648, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1520.4554498195648, "timesteps_since_restore": 286416, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.791525423728812, "ram_util_percent": 6.7593220338983055}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1769.5011559284283, "episode_reward_mean": -1128.539109164173, "episode_len_mean": 569.86, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1117.2016718340133, -959.0103694924369, -961.0577783553407, -1369.142118966434, -1161.6743071292274, -863.9127596303379, -1010.4219036158341, -1063.7949086097851, -925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375], "episode_lengths": [581, 258, 56, 672, 140, 224, 337, 402, 91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.443433192696332, "mean_inference_ms": 10.246231914234668, "mean_action_processing_ms": 0.3068954207352927, "mean_env_wait_ms": 53.626567623412505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 294372, "timesteps_this_iter": 7956, "agent_timesteps_total": 294372, "timers": {"sample_time_ms": 41865.624, "sample_throughput": 190.037, "load_time_ms": 107.078, "load_throughput": 74301.09, "learn_time_ms": 24794.145, "learn_throughput": 320.882, "update_time_ms": 16.218}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 24122.831724581156, "policy_loss": -0.09494336499852599, "vf_loss": 24122.893095857355, "vf_explained_var": -0.26636218777907794, "kl": 0.009829735481454483, "entropy": 0.8923066675182312, "entropy_coeff": 0.0}}}, "num_steps_sampled": 294372, "num_agent_steps_sampled": 294372, "num_steps_trained": 294372, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 294372}, "done": false, "episodes_total": 1625, "training_iteration": 37, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-35-39", "timestamp": 1648647339, "time_this_iter_s": 41.77840232849121, "time_total_s": 1562.233852148056, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1562.233852148056, "timesteps_since_restore": 294372, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 8.751666666666669, "ram_util_percent": 6.765}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1769.5011559284283, "episode_reward_mean": -1135.305387024398, "episode_len_mean": 579.91, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-925.7665543293012, -962.2315214784019, -987.7529579592766, -1223.2358856616436, -970.8682176900904, -978.4716255503344, -1015.2826612512897, -1065.180426569203, -1174.3493394630682, -980.3401000239875, -1117.2646645366685, -1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934], "episode_lengths": [91, 103, 351, 1259, 53, 246, 77, 43, 456, 42, 160, 566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416655012790635, "mean_inference_ms": 10.245877144145545, "mean_action_processing_ms": 0.3063999592306721, "mean_env_wait_ms": 53.644565648044676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 302328, "timesteps_this_iter": 7956, "agent_timesteps_total": 302328, "timers": {"sample_time_ms": 41880.952, "sample_throughput": 189.967, "load_time_ms": 104.52, "load_throughput": 76119.326, "learn_time_ms": 24767.098, "learn_throughput": 321.233, "update_time_ms": 15.854}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 17058.893692492413, "policy_loss": -0.09098026483790368, "vf_loss": 17058.952799265873, "vf_explained_var": -0.23736850869271062, "kl": 0.00935364390869867, "entropy": 0.9345200654960448, "entropy_coeff": 0.0}}}, "num_steps_sampled": 302328, "num_agent_steps_sampled": 302328, "num_steps_trained": 302328, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 302328}, "done": false, "episodes_total": 1633, "training_iteration": 38, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-36-22", "timestamp": 1648647382, "time_this_iter_s": 41.99626350402832, "time_total_s": 1604.2301156520844, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1604.2301156520844, "timesteps_since_restore": 302328, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 8.813333333333333, "ram_util_percent": 6.760000000000001}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1769.5011559284283, "episode_reward_mean": -1145.5378089363521, "episode_len_mean": 621.18, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1496.0836434858438, -1031.3757171504744, -1092.4601346244099, -1223.165558996418, -1252.4864240522068, -1050.9934901831832, -1072.55679752662, -1320.6035048556903, -1283.125344698114, -1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904], "episode_lengths": [566, 74, 411, 454, 498, 133, 436, 454, 261, 229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3794984790102323, "mean_inference_ms": 10.245609767521117, "mean_action_processing_ms": 0.30619080878800475, "mean_env_wait_ms": 53.64052045316535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 310284, "timesteps_this_iter": 7956, "agent_timesteps_total": 310284, "timers": {"sample_time_ms": 41863.499, "sample_throughput": 190.046, "load_time_ms": 104.404, "load_throughput": 76203.875, "learn_time_ms": 24755.887, "learn_throughput": 321.378, "update_time_ms": 15.897}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 20517.127437173167, "policy_loss": -0.0865606622650258, "vf_loss": 20517.184224184097, "vf_explained_var": -0.22631773676282615, "kl": 0.00868805593013498, "entropy": 0.9321576089468053, "entropy_coeff": 0.0}}}, "num_steps_sampled": 310284, "num_agent_steps_sampled": 310284, "num_steps_trained": 310284, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 310284}, "done": false, "episodes_total": 1644, "training_iteration": 39, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-37-03", "timestamp": 1648647423, "time_this_iter_s": 41.654425382614136, "time_total_s": 1645.8845410346985, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1645.8845410346985, "timesteps_since_restore": 310284, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 8.866101694915255, "ram_util_percent": 6.762711864406779}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -1769.5011559284283, "episode_reward_mean": -1140.67629312688, "episode_len_mean": 625.62, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1004.0805724576595, -762.7617298310106, -1111.9344776879705, -986.1599439943642, -1352.324988637256, -898.6629043583908, -1090.4261219290884, -960.3113727927192, -1034.9919997608474, -1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904, -1141.9257359716778, -1288.6654976322116, -1252.130522467419, -1074.0221405387526, -1060.4801385294584, -987.5653130403657, -1236.7399117694285, -1340.3754564409098, -954.7943182355481], "episode_lengths": [229, 827, 532, 1096, 920, 927, 350, 496, 238, 245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012, 444, 274, 1119, 213, 410, 143, 638, 393, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3515794360333824, "mean_inference_ms": 10.244667184794778, "mean_action_processing_ms": 0.3066682503542992, "mean_env_wait_ms": 53.646135488950364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 318240, "timesteps_this_iter": 7956, "agent_timesteps_total": 318240, "timers": {"sample_time_ms": 41848.988, "sample_throughput": 190.112, "load_time_ms": 104.3, "load_throughput": 76280.242, "learn_time_ms": 24753.312, "learn_throughput": 321.412, "update_time_ms": 14.544}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 17956.20986494659, "policy_loss": -0.08870443022579595, "vf_loss": 17956.2681395664, "vf_explained_var": -0.24712811122017522, "kl": 0.008930939254353322, "entropy": 0.8148404815504627, "entropy_coeff": 0.0}}}, "num_steps_sampled": 318240, "num_agent_steps_sampled": 318240, "num_steps_trained": 318240, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 318240}, "done": false, "episodes_total": 1653, "training_iteration": 40, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-37-45", "timestamp": 1648647465, "time_this_iter_s": 41.790571451187134, "time_total_s": 1687.6751124858856, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1687.6751124858856, "timesteps_since_restore": 318240, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 8.933333333333334, "ram_util_percent": 6.789999999999998}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -2176.270468757722, "episode_reward_mean": -1168.4633909923155, "episode_len_mean": 690.04, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1207.219798114517, -1048.9879286715136, -1151.3724039530375, -888.1696128326278, -1068.9929089203724, -1045.1461698782484, -933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904, -1141.9257359716778, -1288.6654976322116, -1252.130522467419, -1074.0221405387526, -1060.4801385294584, -987.5653130403657, -1236.7399117694285, -1340.3754564409098, -954.7943182355481, -904.8045086588402, -999.8047716992276, -1207.089440272946, -2176.270468757722, -1540.2937908877643, -1474.4973220657378, -1406.2609503258252, -1270.020316670674, -1001.3223286541088], "episode_lengths": [245, 25, 248, 457, 1703, 113, 1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012, 444, 274, 1119, 213, 410, 143, 638, 393, 97, 397, 9, 2114, 2592, 1601, 2239, 820, 739, 1546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3240115603131177, "mean_inference_ms": 10.243429544134827, "mean_action_processing_ms": 0.3064398891833899, "mean_env_wait_ms": 53.657399658186016, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 326196, "timesteps_this_iter": 7956, "agent_timesteps_total": 326196, "timers": {"sample_time_ms": 41856.479, "sample_throughput": 190.078, "load_time_ms": 107.02, "load_throughput": 74341.214, "learn_time_ms": 24758.984, "learn_throughput": 321.338, "update_time_ms": 14.854}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 15206.956509924448, "policy_loss": -0.08223886514302864, "vf_loss": 15207.011760276877, "vf_explained_var": -0.35480231921519, "kl": 0.007896408383044964, "entropy": 0.8351683097661182, "entropy_coeff": 0.0}}}, "num_steps_sampled": 326196, "num_agent_steps_sampled": 326196, "num_steps_trained": 326196, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 326196}, "done": false, "episodes_total": 1662, "training_iteration": 41, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-38-27", "timestamp": 1648647507, "time_this_iter_s": 41.842828035354614, "time_total_s": 1729.5179405212402, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1729.5179405212402, "timesteps_since_restore": 326196, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.776666666666667, "ram_util_percent": 6.771666666666666}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -2176.270468757722, "episode_reward_mean": -1193.5061213139381, "episode_len_mean": 743.64, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.8076883301916, -879.1332902590298, -1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904, -1141.9257359716778, -1288.6654976322116, -1252.130522467419, -1074.0221405387526, -1060.4801385294584, -987.5653130403657, -1236.7399117694285, -1340.3754564409098, -954.7943182355481, -904.8045086588402, -999.8047716992276, -1207.089440272946, -2176.270468757722, -1540.2937908877643, -1474.4973220657378, -1406.2609503258252, -1270.020316670674, -1001.3223286541088, -1061.2830994995213, -1043.7552430822313, -1804.897587949299, -1496.3741872756004, -1581.7554666525534, -1926.0962700733742], "episode_lengths": [1071, 1222, 642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012, 444, 274, 1119, 213, 410, 143, 638, 393, 97, 397, 9, 2114, 2592, 1601, 2239, 820, 739, 1546, 482, 137, 1217, 1251, 2701, 2363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2853740536164646, "mean_inference_ms": 10.24570970884812, "mean_action_processing_ms": 0.30667637528721825, "mean_env_wait_ms": 53.67433368675445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 334152, "timesteps_this_iter": 7956, "agent_timesteps_total": 334152, "timers": {"sample_time_ms": 41853.802, "sample_throughput": 190.09, "load_time_ms": 106.924, "load_throughput": 74408.15, "learn_time_ms": 24821.204, "learn_throughput": 320.532, "update_time_ms": 14.65}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 12617.560614456668, "policy_loss": -0.08671054129328538, "vf_loss": 12617.616322835287, "vf_explained_var": -0.3759914224186251, "kl": 0.00907413360001919, "entropy": 0.8921438611322834, "entropy_coeff": 0.0}}}, "num_steps_sampled": 334152, "num_agent_steps_sampled": 334152, "num_steps_trained": 334152, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 334152}, "done": false, "episodes_total": 1668, "training_iteration": 42, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-39-09", "timestamp": 1648647549, "time_this_iter_s": 42.15278959274292, "time_total_s": 1771.6707301139832, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1771.6707301139832, "timesteps_since_restore": 334152, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.91694915254237, "ram_util_percent": 6.7762711864406775}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -2176.270468757722, "episode_reward_mean": -1193.6400883996853, "episode_len_mean": 727.74, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1359.883557719609, -750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904, -1141.9257359716778, -1288.6654976322116, -1252.130522467419, -1074.0221405387526, -1060.4801385294584, -987.5653130403657, -1236.7399117694285, -1340.3754564409098, -954.7943182355481, -904.8045086588402, -999.8047716992276, -1207.089440272946, -2176.270468757722, -1540.2937908877643, -1474.4973220657378, -1406.2609503258252, -1270.020316670674, -1001.3223286541088, -1061.2830994995213, -1043.7552430822313, -1804.897587949299, -1496.3741872756004, -1581.7554666525534, -1926.0962700733742, -759.4372551940565, -1066.9004319698743], "episode_lengths": [642, 1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012, 444, 274, 1119, 213, 410, 143, 638, 393, 97, 397, 9, 2114, 2592, 1601, 2239, 820, 739, 1546, 482, 137, 1217, 1251, 2701, 2363, 601, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2797722350644154, "mean_inference_ms": 10.24561889679483, "mean_action_processing_ms": 0.30674074136502105, "mean_env_wait_ms": 53.67431788267638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 342108, "timesteps_this_iter": 7956, "agent_timesteps_total": 342108, "timers": {"sample_time_ms": 41895.994, "sample_throughput": 189.899, "load_time_ms": 107.022, "load_throughput": 74339.525, "learn_time_ms": 24814.453, "learn_throughput": 320.62, "update_time_ms": 14.111}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 7534.605202968146, "policy_loss": -0.08523417559993123, "vf_loss": 7534.6617657241, "vf_explained_var": -0.44443830450375876, "kl": 0.00840363502850789, "entropy": 0.7803927225771771, "entropy_coeff": 0.0}}}, "num_steps_sampled": 342108, "num_agent_steps_sampled": 342108, "num_steps_trained": 342108, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 342108}, "done": false, "episodes_total": 1670, "training_iteration": 43, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-39-51", "timestamp": 1648647591, "time_this_iter_s": 41.5959575176239, "time_total_s": 1813.266687631607, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1813.266687631607, "timesteps_since_restore": 342108, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.781666666666666, "ram_util_percent": 6.760000000000001}}
{"episode_reward_max": -750.9924819527997, "episode_reward_min": -2176.270468757722, "episode_reward_mean": -1190.1066172927897, "episode_len_mean": 736.28, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-750.9924819527997, -1116.636696406647, -1034.9082229482033, -1102.2891669680303, -1544.0725557017622, -1056.8494257347638, -1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904, -1141.9257359716778, -1288.6654976322116, -1252.130522467419, -1074.0221405387526, -1060.4801385294584, -987.5653130403657, -1236.7399117694285, -1340.3754564409098, -954.7943182355481, -904.8045086588402, -999.8047716992276, -1207.089440272946, -2176.270468757722, -1540.2937908877643, -1474.4973220657378, -1406.2609503258252, -1270.020316670674, -1001.3223286541088, -1061.2830994995213, -1043.7552430822313, -1804.897587949299, -1496.3741872756004, -1581.7554666525534, -1926.0962700733742, -759.4372551940565, -1066.9004319698743, -1006.5364470300441], "episode_lengths": [1016, 186, 51, 888, 1725, 208, 454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012, 444, 274, 1119, 213, 410, 143, 638, 393, 97, 397, 9, 2114, 2592, 1601, 2239, 820, 739, 1546, 482, 137, 1217, 1251, 2701, 2363, 601, 102, 1496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.275257141247691, "mean_inference_ms": 10.246196550059265, "mean_action_processing_ms": 0.3069139439937489, "mean_env_wait_ms": 53.67395043391823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 350064, "timesteps_this_iter": 7956, "agent_timesteps_total": 350064, "timers": {"sample_time_ms": 41896.915, "sample_throughput": 189.895, "load_time_ms": 107.126, "load_throughput": 74267.488, "learn_time_ms": 24814.235, "learn_throughput": 320.622, "update_time_ms": 71.563}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 5409.108104283323, "policy_loss": -0.0909642906584126, "vf_loss": 5409.16714470566, "vf_explained_var": -0.39409419160376313, "kl": 0.009347786435248112, "entropy": 0.7590751405685179, "entropy_coeff": 0.0}}}, "num_steps_sampled": 350064, "num_agent_steps_sampled": 350064, "num_steps_trained": 350064, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 350064}, "done": false, "episodes_total": 1671, "training_iteration": 44, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-40-33", "timestamp": 1648647633, "time_this_iter_s": 42.34253740310669, "time_total_s": 1855.6092250347137, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1855.6092250347137, "timesteps_since_restore": 350064, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 8.728333333333332, "ram_util_percent": 6.776666666666666}}
{"episode_reward_max": -714.4473220169825, "episode_reward_min": -2176.270468757722, "episode_reward_mean": -1190.9414810629555, "episode_len_mean": 778.97, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1098.2483508868334, -987.5956316916576, -1026.7925824506196, -948.0882556668838, -1175.534646206184, -1174.2424047214085, -986.800511343691, -986.270094995233, -1234.6575806324477, -1095.15828808608, -1425.9516857905373, -1362.2384307094892, -1385.7760455659788, -1166.7484572279152, -1209.2020197262295, -1148.2986551636695, -957.026529402081, -1115.6571439622232, -1769.5011559284283, -1309.2436568287576, -1577.4167150465678, -1441.2040679025972, -1250.3549592208356, -1209.1819916140726, -1066.4541204203617, -1203.1301176323882, -944.3797924204065, -1336.5562903343346, -1320.7629026024908, -946.999354459954, -1079.7918472835079, -1552.7700325308601, -1167.454654073531, -1607.0305012466433, -964.9271911875518, -1033.089441747923, -1263.0916519581967, -809.9688277676277, -1014.9119448905002, -999.7444258396729, -1357.1858390227505, -1039.0156393984878, -1322.182583706417, -989.975005689025, -1088.8247409139897, -1203.7934248435988, -1010.7360898782329, -1370.0182282381375, -1064.8929284697347, -1041.9379549948517, -1032.705379986637, -1104.529599408617, -1331.0825922689037, -1705.184997092022, -855.901468540453, -1046.6086828946934, -994.131866403509, -1072.3674210958618, -881.5882162292296, -1111.6202392292053, -968.1881859255213, -1345.2351825148617, -1301.5684508896893, -1063.1043447854427, -1223.4587709282864, -1093.0083833931428, -1369.715084313904, -1141.9257359716778, -1288.6654976322116, -1252.130522467419, -1074.0221405387526, -1060.4801385294584, -987.5653130403657, -1236.7399117694285, -1340.3754564409098, -954.7943182355481, -904.8045086588402, -999.8047716992276, -1207.089440272946, -2176.270468757722, -1540.2937908877643, -1474.4973220657378, -1406.2609503258252, -1270.020316670674, -1001.3223286541088, -1061.2830994995213, -1043.7552430822313, -1804.897587949299, -1496.3741872756004, -1581.7554666525534, -1926.0962700733742, -759.4372551940565, -1066.9004319698743, -1006.5364470300441, -1159.1788196014031, -1098.2195190911884, -1251.8677891800266, -1488.1970307581744, -977.3244460810067, -714.4473220169825], "episode_lengths": [454, 30, 76, 459, 275, 417, 475, 162, 461, 386, 1061, 868, 890, 499, 727, 354, 98, 276, 2536, 771, 1011, 1872, 1448, 820, 1197, 537, 100, 1037, 529, 369, 222, 1807, 491, 1168, 88, 533, 251, 993, 205, 10, 507, 1081, 1181, 1816, 128, 569, 354, 1134, 187, 32, 57, 382, 854, 1782, 275, 106, 725, 696, 745, 629, 55, 714, 715, 314, 1205, 198, 1012, 444, 274, 1119, 213, 410, 143, 638, 393, 97, 397, 9, 2114, 2592, 1601, 2239, 820, 739, 1546, 482, 137, 1217, 1251, 2701, 2363, 601, 102, 1496, 2542, 1671, 1744, 1224, 158, 1004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2536714704957705, "mean_inference_ms": 10.245378222611722, "mean_action_processing_ms": 0.30640910179961184, "mean_env_wait_ms": 53.67946036815808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 34, "timesteps_total": 358020, "timesteps_this_iter": 7956, "agent_timesteps_total": 358020, "timers": {"sample_time_ms": 41949.121, "sample_throughput": 189.658, "load_time_ms": 107.216, "load_throughput": 74205.408, "learn_time_ms": 24807.305, "learn_throughput": 320.712, "update_time_ms": 71.795}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187499999999, "cur_lr": 0.00010000000000000003, "total_loss": 14387.96950043709, "policy_loss": -0.07692261417271189, "vf_loss": 14388.021013912077, "vf_explained_var": -0.35571055300133203, "kl": 0.007422056052646258, "entropy": 0.8091226450458009, "entropy_coeff": 0.0}}}, "num_steps_sampled": 358020, "num_agent_steps_sampled": 358020, "num_steps_trained": 358020, "num_steps_trained_this_iter": 7956, "num_agent_steps_trained": 358020}, "done": false, "episodes_total": 1677, "training_iteration": 45, "trial_id": "958e3_00000", "experiment_id": "b96e6090e17c433ab2ddf2be312e6ca6", "date": "2022-03-30_13-41-15", "timestamp": 1648647675, "time_this_iter_s": 41.763108253479004, "time_total_s": 1897.3723332881927, "pid": 229562, "hostname": "cee140e1a855", "node_ip": "172.17.0.4", "config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 34, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 117, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Duckietown", "observation_space": null, "action_space": null, "env_config": {"seed": 91352, "map_name": "loop_empty", "max_steps": 5000, "camera_width": 640, "camera_height": 480, "accept_start_angle_deg": 40, "full_transparency": true, "distortion": true, "domain_rand": false}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1897.3723332881927, "timesteps_since_restore": 358020, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 8.928813559322034, "ram_util_percent": 6.762711864406779}}
